var e={400:(t,e,n)=>{n(650)},650:(t,e)=>{function n(t,e,n=!1){let i=0,r=!1,o=!1,s=0,c=!1,l=[];const a=[];for(let u=0;u<t.length;u++){if(!0===o){o=!1;continue}const h=t[u];if("line"!==c)if("block"!==c)if("'"!==h){if(r){if("\\"===h){o=!0;continue}}else if("{"!==h&&"["!==h)if("}"!==h&&"]"!==h){if(!(i>0))if(","!==h&&"\n"!==h){if(!(s<u))if(0!==h.trimEnd().length){if("/"===h){const e=t[u+1];if("/"===e){s=u,u++,c="line";continue}if("*"===e){s=u,u++,c="block";continue}}}else s=u+1}else{const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]),s=u+1}}else{if(i--,i<0){const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]);break}0===i&&(a.push({value:t.slice(s,u+1),index:e+s,comment:l.join("\n")}),l=[],s=u+1)}else if(i++,1===i&&!n){const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]),s=u}}else{if(!r){if(r=!0,0===i&&!n){const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]),s=u}continue}r=!1,0===i&&(a.push({value:t.slice(s,u+1),index:e+s,comment:l.join("\n")}),l=[],s=u+1)}else"*"===h&&"/"===t[u+1]&&(u++,c=!1,l.push(t.slice(s,u+1).replace(/\n[ ]*/g,"\n ")),s=u+1);else"\n"===h&&(c=!1,l.push(t.slice(s,u).trimEnd()),s=u+1)}if(!r&&0===i&&!1===c){const n=t.slice(s).trimEnd();n.length>0&&a.push({value:n,index:e+s,comment:l.join("\n")})}return a}function i(t,e=!1){let n=0,i=!1,r=!1,o=0,s=!1;const c=[];for(let l=0;l<t.length;l++){if(!0===r){r=!1;continue}const a=t[l];if("line"!==s)if("block"!==s)if("'"!==a){if(i){if("\\"===a){r=!0;continue}}else if("{"!==a&&"["!==a)if("}"!==a&&"]"!==a){if(!(n>0))if(","!==a&&"\n"!==a){if(!(o<l))if(0!==a.trimEnd().length){if("/"===a){const e=t[l+1];if("/"===e){l++,s="line",o=l+1;continue}if("*"===e){l++,s="block",o=l+1;continue}}}else o=l+1}else{const e=t.slice(o,l).trimEnd();e.length>0&&c.push(e),o=l+1}}else{if(n--,n<0){const e=t.slice(o,l).trimEnd();e.length>0&&c.push(e);break}0===n&&(c.push(t.slice(o,l+1)),o=l+1)}else if(n++,1===n&&!e){const e=t.slice(o,l).trimEnd();e.length>0&&c.push(e),o=l}}else{if(!i){if(i=!0,0===n&&!e){const e=t.slice(o,l).trimEnd();e.length>0&&c.push(e),o=l}continue}i=!1,0===n&&(c.push(t.slice(o,l+1)),o=l+1)}else"*"===a&&"/"===t[l+1]&&(l++,s=!1),o=l+1;else"\n"===a&&(s=!1),o=l+1}if(!i&&0===n){const e=t.slice(o).trimEnd();e.length>0&&c.push(e)}return c}function r(t){const e=[];let n=!1;for(const i of t)if(!0!==n)if("\\"!==i){if("'"===i)break;e.push(i)}else n=!0;else n=!1,"\\"!==i&&"'"!==i&&e.push("\\"),e.push(i);return e.join("")}function o(t,e=0,i=""){e+=t.length;const s=function(t,e){if(0===t.length)return;const i=t[0];return"'"===i?r(t.slice(1)):"["===i?function(t,e){return function(t){const e=[];for(const{value:n,index:i,comment:r}of t){const t=o(n,i,r);if(void 0===t)return;e.push(t)}return e}(n(t,e))}(t.slice(1),e+1):"{"===i?function(t,e){return function(t){const e={};for(const{value:n,index:i,comment:r}of t){const t=n.match(/^\s*([\w-]+)/);if(null===t){const t=o(n,i,r);if(void 0===t)return;e.__=t;continue}const s=t[1],c=t[0].length;let l=n.slice(c).trimEnd();if(0===l.length)e[s]={value:!0,index:i+c,comment:r};else{const t=o(l,i+c,r);if(void 0===t)return;e[s]=t}}return e}(n(t,e,!0))}(t.slice(1),e+1):"true"===(t=t.trimEnd())||"false"!==t&&(/^(?:[+-]?Infinity|NaN|0x[\da-fA-F]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(t)?Number(t):/[',{}\[\]\n\r]/.test(t)?void 0:t)}(t=t.trimStart(),e-=t.length);if(void 0!==s)return{value:s,index:e,comment:i}}function s(t){if(0===(t=t.trimStart()).length)return;const e=t[0];return"'"===e?r(t.slice(1)):"["===e?function(t){return function(t){const e=[];for(const n of t){const t=s(n);if(void 0===t)return;e.push(t)}return e}(i(t))}(t.slice(1)):"{"===e?function(t){return function(t){const e={};for(const n of t){const t=n.match(/^\s*([\w-]+)/);if(null===t){const t=s(n);if(void 0===t)return;e.__=t;continue}const i=t[1],r=t[0].length;let o=n.slice(r).trimEnd();if(0===o.length)e[i]=!0;else{const t=s(o);if(void 0===t)return;e[i]=t}}return e}(i(t,!0))}(t.slice(1)):"true"===(t=t.trimEnd())||"false"!==t&&(/^(?:[+-]?Infinity|NaN|0x[\da-fA-F]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(t)?Number(t):/[',{}\[\]\n\r]/.test(t)?void 0:t)}function c(t,e){if(e&&t.length>0&&t[0].trim().length>0&&(1===t.length||t[t.length-1].trim().length>0)&&!/[',{}\[\]\n\r]/.test(t)&&"true"!==t&&"false"!==t&&!/^(?:[+-]?Infinity|NaN|0x[\da-fA-F]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(t)&&!t.startsWith("//")&&!t.startsWith("/*"))return t;const n=["'"];for(let e=0;e<t.length;e++){const i=t[e];if("\\"!==i)"'"!==i?n.push(i):n.push("\\'");else{if(e===t.length-1){n.push("\\\\");break}const r=t[e+1];if("\\"===r||"'"===r){n.push("\\\\");continue}n.push(i)}}return n.push("'"),n.join("")}Object.defineProperty(e,"__esModule",{value:!0}),e.stringify=e.stringifyWithComment=e.parse=e.parseWithIndex=void 0,e.parseWithIndex=o,e.parse=s,e.stringifyWithComment=function t(e,n={}){return void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?c(e,n.useUnquotedString):!0===e?"true":!1===e?"false":Array.isArray(e)?function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s}){n=n??"none",i=i??0,r=r??"never";const c=[],l=e.length>1&&("all"===n||"array"===n||"arrayInObjectAndThis"===n)||void 0!==e.find((t=>t.comment.length>0)),a=i+(l?1:0);"arrayInObjectAndThis"===n&&(n="arrayInObject");const u="always"===o||"afterComma"===o?", ":",";let h;for(let i=0;i<e.length;i++){const{value:f,comment:d}=e[i];let p;p=void 0===h?t(f,{indentTarget:n,indentLevel:a,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s}):h,i!==e.length-1&&(h=t(e[i+1].value,{indentTarget:n,indentLevel:a,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s})),l||i===e.length-1||"always"!==r&&(p.endsWith("'")||p.endsWith("}")||p.endsWith("]")||void 0!==h&&(h.endsWith("'")||h.endsWith("}")||h.endsWith("]")))?(d.length>0&&c.push(...d.split("\n")),c.push(p)):c.push(p+u)}let f="\n";for(let t=0;t<i;t++)f+="    ";let d=f;return i>=0&&(d+="    "),l?"["+d+c.join(d)+f+"]":"["+c.join("")+"]"}(e,n):function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s}){n=n??"none",i=i??0,r=r??"never";const c=[],l=Object.keys(e);let a=l.length>1&&("all"===n||"object"===n);if(!a)for(const t of l){const n=e[t];if(void 0!==n&&n.comment.length>0){a=!0;break}}const u=i+(a?1:0);"arrayInObject"===n&&(n="arrayInObjectAndThis");const h="always"===o||"afterComma"===o?", ":",",f="always"===o||"afterKey"===o?" ":"";for(let i=0;i<l.length;i++){const d=l[i];if(null===d.match(/^[\w-]+$/))continue;const p=e[d];if(void 0===p)continue;const{value:m,comment:y}=p,g=t(m,{indentTarget:n,indentLevel:u,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:"__"===d&&"string"==typeof m?void 0:s});y.length>0&&c.push(...y.split("\n")),g.startsWith("'")||g.startsWith("[")||g.startsWith("{")?a||i===l.length-1||"always"!==r&&"inObject"!==r?c.push(("__"===d?"":d+f)+g):c.push(("__"===d?"":d+f)+g+h):"true"===g?a||i===l.length-1?c.push(d):c.push(d+h):a||i===l.length-1?c.push(d+" "+g):c.push(d+" "+g+h)}let d="\n";for(let t=0;t<i;t++)d+="    ";let p=d;return i>=0&&(p+="    "),a?"{"+p+c.join(p)+d+"}":"{"+c.join("")+"}"}(e,n)},e.stringify=function t(e,n={}){return void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?c(e,n.useUnquotedString):!0===e?"true":!1===e?"false":Array.isArray(e)?function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s}){n=n??"none",i=i??0,r=r??"never";const c=[],l=e.length>1&&("all"===n||"array"===n||"arrayInObjectAndThis"===n),a=i+(l?1:0);"arrayInObjectAndThis"===n&&(n="arrayInObject");const u="always"===o||"afterComma"===o?", ":",";let h;for(let i=0;i<e.length;i++){let f;f=void 0===h?t(e[i],{indentTarget:n,indentLevel:a,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s}):h,i!==e.length-1&&(h=t(e[i+1],{indentTarget:n,indentLevel:a,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s})),l||i===e.length-1||"always"!==r&&(f.endsWith("'")||f.endsWith("}")||f.endsWith("]")||void 0!==h&&(h.endsWith("'")||h.endsWith("}")||h.endsWith("]")))?c.push(f):c.push(f+u)}let f="\n";for(let t=0;t<i;t++)f+="    ";let d=f;return i>=0&&(d+="    "),l?"["+d+c.join(d)+f+"]":"["+c.join("")+"]"}(e,n):function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:s}){n=n??"none",i=i??0,r=r??"never";const c=[],l=Object.keys(e),a=l.length>1&&("all"===n||"object"===n),u=i+(a?1:0);"arrayInObject"===n&&(n="arrayInObjectAndThis");const h="always"===o||"afterComma"===o?", ":",",f="always"===o||"afterKey"===o?" ":"";for(let i=0;i<l.length;i++){const d=l[i];if(null===d.match(/^[\w-]+$/))continue;const p=e[d];if(void 0===p)continue;const m=t(p,{indentTarget:n,indentLevel:u,addDecorativeComma:r,addDecorativeSpace:o,useUnquotedString:"__"===d&&"string"==typeof p?void 0:s});m.startsWith("'")||m.startsWith("[")||m.startsWith("{")?a||i===l.length-1||"always"!==r&&"inObject"!==r?c.push(("__"===d?"":d+f)+m):c.push(("__"===d?"":d+f)+m+h):"true"===m?a||i===l.length-1?c.push(d):c.push(d+h):a||i===l.length-1?c.push(d+" "+m):c.push(d+" "+m+h)}let d="\n";for(let t=0;t<i;t++)d+="    ";let p=d;return i>=0&&(p+="    "),a?"{"+p+c.join(p)+d+"}":"{"+c.join("")+"}"}(e,n)}}},n={};function i(t){var r=n[t];if(void 0!==r)return r.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,i),o.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};(()=>{function e(t,e){try{return new URL(t,e).href}catch(e){return console.log(e),t}}function n(t){if(0===t.length)return"";let e="";for(const i of t[0])e+="string"!=typeof i?n(i.children):i;return e}function o(t){return Array.from(t.slice(0,100).matchAll(/[a-zA-Z0-9]+/g)).join("-").toLowerCase()}function s(t,e,n){const i=n[e];return void 0===i?[]:i[t]??[]}i.d(r,{aC:()=>H,cd:()=>nt,Zg:()=>X,Co:()=>et,rY:()=>G,T_:()=>R,in:()=>V,vi:()=>$,vy:()=>P,Im:()=>q,D8:()=>F,xA:()=>U,li:()=>B,$_:()=>tt}),i(650),i(400);class c{constructor(t,e=[]){this.element=document.createElement(t),this.classList=this.element.classList,this.style=this.element.style,this.dataset=this.element.dataset,this.childNodes=this.element.childNodes,this.children=this.element.children;for(const t of e)if(t.length>0)try{this.element.classList.add(t.replace(/\s/g,"-"))}catch(t){console.log(t)}}append(...t){return this.element.append(...t.map((t=>t instanceof c?t.element:t))),this}prepend(...t){return this.element.prepend(...t.map((t=>t instanceof c?t.element:t))),this}after(...t){return this.element.after(...t.map((t=>t instanceof c?t.element:t))),this}before(...t){return this.element.before(...t.map((t=>t instanceof c?t.element:t))),this}setText(t){return this.element.textContent=t,this}setHTML(t){return this.element.innerHTML=t,this}scrollBy(t){return this.element.scrollBy(t),this}scrollIntoView(t){return this.element.scrollIntoView(t),this}getBoundingClientRect(){return this.element.getBoundingClientRect()}getClientRects(){return this.element.getClientRects()}setAttribute(t,e){try{this.element.setAttribute(t,e)}catch(t){console.log(t)}return this}removeAttribute(t){return this.element.removeAttribute(t),this}getAttribute(t){return this.element.getAttribute(t)}hasAttribute(t){return this.element.hasAttribute(t)}}class l extends c{constructor(t=[]){super("div",t)}addEventListener(t,e,n){return this.element.addEventListener(t,e,n),this}}class a extends c{constructor(t=[]){super("span",t)}addEventListener(t,e,n){return this.element.addEventListener(t,e,n),this}}class u{constructor(t){this.context=t,this.unitToCompiling=new Map}async compileUnit(t){if(!0===this.unitToCompiling.get(t))return u.createErrorElement("Loop");if("global"===t.tag||!0===t.options.global)return new l(["unit","global"]).element;this.unitToCompiling.set(t,!0);let n=t.options["compile-with"]??function(t,e,n){const i=s("compile-with",e,n);if(0!==i.length)return i[i.length-1]}(0,t.tag,this.context.tagToGlobalOptions);"string"==typeof n&&0!==n.length||(n=t.tag);const i=this.context.tagToUnitCompiler[n];let r;if(void 0!==i){try{r=await i(t,this)}catch(t){console.log(t),r=u.createErrorElement("Broken")}if(r.classList.contains("warn"))return r.classList.add("unit"),this.unitToCompiling.set(t,!1),r}else{let e;u.supportedHTMLTags.includes(n)?(r=document.createElement(n),e=u.supportedHTMLTagsWithInlineChildren.includes(n)?await this.compileInlineSTDN(t.children):await this.compileSTDN(t.children)):u.supportedSVGTags.includes(n)?(r=document.createElementNS("http://www.w3.org/2000/svg",n),e=await this.compileInlineSTDN(t.children)):(r=document.createElement("div"),e=await this.compileSTDN(t.children)),r.append(e)}r.classList.add("unit");try{r.classList.add(n),"string"==typeof t.options.class&&r.classList.add(...t.options.class.trim().split(/\s+/));for(const e of s("class",t.tag,this.context.tagToGlobalOptions))"string"==typeof e&&r.classList.add(...e.trim().split(/\s+/))}catch(t){console.log(t)}const o=this.context.unitToId.get(t);void 0!==o&&(r.id=o);for(const n of Object.keys(t.options)){if("id"===n||"class"===n)continue;let i=n;if(n.startsWith("data-")||u.supportedHTMLAttributes.includes(n)||(i=`data-${n}`),r.hasAttribute(i))continue;let o=t.options[n];if(!0===o?o="":"number"==typeof o&&(o=o.toString()),"string"==typeof o){this.context.dir.length>0&&("src"===i||"href"===i)&&(!(c=o).startsWith("#")&&!/^[a-z][a-z0-9+.-]*:/i.test(c))&&(o=e(o,this.context.dir));try{r.setAttribute(i,o)}catch(t){console.log(t)}}}var c;return this.unitToCompiling.set(t,!1),r}async compileInline(t){return"string"!=typeof t?await this.compileUnit(t):new Text(t)}async compileLine(t){const e=new DocumentFragment;for(const n of t)e.append(await this.compileInline(n));return e}async compileInlineSTDN(t){const e=new DocumentFragment;for(let n=0;n<t.length;n++)e.append(await this.compileLine(t[n])),n!==t.length-1&&e.append(new Text("\n"));return e}async compileSTDN(t){const e=new DocumentFragment;for(const n of t)e.append(new l(["st-line"]).append(await this.compileLine(n)).element);return e}static createErrorElement(t){return new a(["unit","warn"]).setText(t).element}}u.supportedHTMLTags=["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rp","rt","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","area","audio","img","map","track","video","iframe","del","ins","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],u.supportedHTMLTagsWithInlineChildren=["a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rp","rt","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","audio","img","track","video","iframe","del","ins","col","colgroup","table","tbody","tfoot","thead","tr"],u.supportedSVGTags=["animate","animateMotion","circle","ellipse","foreignObject","g","image","path","rect","svg","text","textPath","tspan"],u.supportedHTMLAttributes=["accesskey","align","allow","alt","autoplay","cite","class","cols","colspan","controls","coords","crossorigin","datetime","decoding","default","dir","download","draggable","for","headers","href","hreflang","id","kind","label","lang","loop","muted","name","open","ping","poster","preload","referrerpolicy","rel","reversed","rows","rowspan","sandbox","scope","span","spellcheck","src","srcdoc","srclang","srcset","start","style","tabindex","target","title","translate","usemap","value","attributeName","begin","d","dur","fill","keyPoints","keyTimes","path","preserveAspectRatio","repeatCount","rotate","textLength","values","viewBox","x","y"];const{abs:h,cos:f,sin:d,acos:p,atan2:m,sqrt:y,pow:g}=Math;function x(t){return t<0?-g(-t,1/3):g(t,1/3)}const v=Math.PI,b=2*v,w=v/2,z=Number.MAX_SAFE_INTEGER||9007199254740991,_=Number.MIN_SAFE_INTEGER||-9007199254740991,T={x:0,y:0,z:0},E={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){const n=e(t);let i=n.x*n.x+n.y*n.y;return void 0!==n.z&&(i+=n.z*n.z),y(i)},compute:function(t,e,n){if(0===t)return e[0].t=0,e[0];const i=e.length-1;if(1===t)return e[i].t=1,e[i];const r=1-t;let o=e;if(0===i)return e[0].t=t,e[0];if(1===i){const e={x:r*o[0].x+t*o[1].x,y:r*o[0].y+t*o[1].y,t};return n&&(e.z=r*o[0].z+t*o[1].z),e}if(i<4){let e,s,c,l=r*r,a=t*t,u=0;2===i?(o=[o[0],o[1],o[2],T],e=l,s=r*t*2,c=a):3===i&&(e=l*r,s=l*t*3,c=r*a*3,u=t*a);const h={x:e*o[0].x+s*o[1].x+c*o[2].x+u*o[3].x,y:e*o[0].y+s*o[1].y+c*o[2].y+u*o[3].y,t};return n&&(h.z=e*o[0].z+s*o[1].z+c*o[2].z+u*o[3].z),h}const s=JSON.parse(JSON.stringify(e));for(;s.length>1;){for(let e=0;e<s.length-1;e++)s[e]={x:s[e].x+(s[e+1].x-s[e].x)*t,y:s[e].y+(s[e+1].y-s[e].y)*t},void 0!==s[e].z&&(s[e]=s[e].z+(s[e+1].z-s[e].z)*t);s.splice(s.length-1,1)}return s[0].t=t,s[0]},computeWithRatios:function(t,e,n,i){const r=1-t,o=n,s=e;let c,l=o[0],a=o[1],u=o[2],h=o[3];return l*=r,a*=t,2===s.length?(c=l+a,{x:(l*s[0].x+a*s[1].x)/c,y:(l*s[0].y+a*s[1].y)/c,z:!!i&&(l*s[0].z+a*s[1].z)/c,t}):(l*=r,a*=2*r,u*=t*t,3===s.length?(c=l+a+u,{x:(l*s[0].x+a*s[1].x+u*s[2].x)/c,y:(l*s[0].y+a*s[1].y+u*s[2].y)/c,z:!!i&&(l*s[0].z+a*s[1].z+u*s[2].z)/c,t}):(l*=r,a*=1.5*r,u*=3*r,h*=t*t*t,4===s.length?(c=l+a+u+h,{x:(l*s[0].x+a*s[1].x+u*s[2].x+h*s[3].x)/c,y:(l*s[0].y+a*s[1].y+u*s[2].y+h*s[3].y)/c,z:!!i&&(l*s[0].z+a*s[1].z+u*s[2].z+h*s[3].z)/c,t}):void 0))},derive:function(t,e){const n=[];for(let i=t,r=i.length,o=r-1;r>1;r--,o--){const t=[];for(let n,r=0;r<o;r++)n={x:o*(i[r+1].x-i[r].x),y:o*(i[r+1].y-i[r].y)},e&&(n.z=o*(i[r+1].z-i[r].z)),t.push(n);n.push(t),i=t}return n},between:function(t,e,n){return e<=t&&t<=n||E.approximately(t,e)||E.approximately(t,n)},approximately:function(t,e,n){return h(t-e)<=(n||1e-6)},length:function(t){const e=E.Tvalues.length;let n=0;for(let i,r=0;r<e;r++)i=.5*E.Tvalues[r]+.5,n+=E.Cvalues[r]*E.arcfn(i,t);return.5*n},map:function(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)},lerp:function(t,e,n){const i={x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)};return void 0!==e.z&&void 0!==n.z&&(i.z=e.z+t*(n.z-e.z)),i},pointToString:function(t){let e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(E.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,n){const i=e.x-t.x,r=e.y-t.y,o=n.x-t.x,s=n.y-t.y;return m(i*s-r*o,i*o+r*s)},round:function(t,e){const n=""+t,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(t,e){const n=t.x-e.x,i=t.y-e.y;return y(n*n+i*i)},closest:function(t,e){let n,i,r=g(2,63);return t.forEach((function(t,o){i=E.dist(e,t),i<r&&(r=i,n=o)})),{mdist:r,mpos:n}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const n=g(t,e)+g(1-t,e);return h((n-1)/n)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const n=g(1-t,e);return n/(g(t,e)+n)},lli8:function(t,e,n,i,r,o,s,c){const l=(t-n)*(o-c)-(e-i)*(r-s);return 0!=l&&{x:((t*i-e*n)*(r-s)-(t-n)*(r*c-o*s))/l,y:((t*i-e*n)*(o-c)-(e-i)*(r*c-o*s))/l}},lli4:function(t,e,n,i){const r=t.x,o=t.y,s=e.x,c=e.y,l=n.x,a=n.y,u=i.x,h=i.y;return E.lli8(r,o,s,c,l,a,u,h)},lli:function(t,e){return E.lli4(t,t.c,e,e.c)},makeline:function(t,e){const n=t.x,i=t.y,r=e.x,o=e.y,s=(r-n)/3,c=(o-i)/3;return new D(n,i,n+s,i+c,n+2*s,i+2*c,r,o)},findbbox:function(t){let e=z,n=z,i=_,r=_;return t.forEach((function(t){const o=t.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),r<o.y.max&&(r=o.y.max)})),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+r)/2,max:r,size:r-n}}},shapeintersections:function(t,e,n,i,r){if(!E.bboxoverlap(e,i))return[];const o=[],s=[t.startcap,t.forward,t.back,t.endcap],c=[n.startcap,n.forward,n.back,n.endcap];return s.forEach((function(e){e.virtual||c.forEach((function(i){if(i.virtual)return;const s=e.intersects(i,r);s.length>0&&(s.c1=e,s.c2=i,s.s1=t,s.s2=n,o.push(s))}))})),o},makeshape:function(t,e,n){const i=e.points.length,r=t.points.length,o=E.makeline(e.points[i-1],t.points[0]),s=E.makeline(t.points[r-1],e.points[0]),c={startcap:o,forward:t,back:e,endcap:s,bbox:E.findbbox([o,t,e,s]),intersections:function(t){return E.shapeintersections(c,c.bbox,t,t.bbox,n)}};return c},getminmax:function(t,e,n){if(!n)return{min:0,max:0};let i,r,o=z,s=_;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(let c=0,l=n.length;c<l;c++)i=n[c],r=t.get(i),r[e]<o&&(o=r[e]),r[e]>s&&(s=r[e]);return{min:o,mid:(o+s)/2,max:s,size:s-o}},align:function(t,e){const n=e.p1.x,i=e.p1.y,r=-m(e.p2.y-i,e.p2.x-n);return t.map((function(t){return{x:(t.x-n)*f(r)-(t.y-i)*d(r),y:(t.x-n)*d(r)+(t.y-i)*f(r)}}))},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=t.length-1,i=E.align(t,e),r=function(t){return 0<=t&&t<=1};if(2===n){const t=i[0].y,e=i[1].y,n=i[2].y,o=t-2*e+n;if(0!==o){const i=-y(e*e-t*n),s=-t+e;return[-(i+s)/o,-(-i+s)/o].filter(r)}return e!==n&&0===o?[(2*e-n)/(2*e-2*n)].filter(r):[]}const o=i[0].y,s=i[1].y,c=i[2].y;let l=3*s-o-3*c+i[3].y,a=3*o-6*s+3*c,u=-3*o+3*s,h=o;if(E.approximately(l,0)){if(E.approximately(a,0))return E.approximately(u,0)?[]:[-h/u].filter(r);const t=y(u*u-4*a*h),e=2*a;return[(t-u)/e,(-u-t)/e].filter(r)}a/=l,u/=l,h/=l;const d=(3*u-a*a)/3,m=d/3,g=(2*a*a*a-9*a*u+27*h)/27,v=g/2,w=v*v+m*m*m;let z,_,T,S,k;if(w<0){const t=-d/3,e=y(t*t*t),n=-g/(2*e),i=p(n<-1?-1:n>1?1:n),o=2*x(e);return T=o*f(i/3)-a/3,S=o*f((i+b)/3)-a/3,k=o*f((i+2*b)/3)-a/3,[T,S,k].filter(r)}if(0===w)return z=v<0?x(-v):-x(v),T=2*z-a/3,S=-z-a/3,[T,S].filter(r);{const t=y(w);return z=x(-v+t),_=x(v+t),[z-_-a/3].filter(r)}},droots:function(t){if(3===t.length){const e=t[0],n=t[1],i=t[2],r=e-2*n+i;if(0!==r){const t=-y(n*n-e*i),o=-e+n;return[-(t+o)/r,-(-t+o)/r]}return n!==i&&0===r?[(2*n-i)/(2*(n-i))]:[]}if(2===t.length){const e=t[0],n=t[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(t,e,n,i,r){let o,s,c,l,a=0,u=0;const f=E.compute(t,e),d=E.compute(t,n),p=f.x*f.x+f.y*f.y;if(i?(o=y(g(f.y*d.z-d.y*f.z,2)+g(f.z*d.x-d.z*f.x,2)+g(f.x*d.y-d.x*f.y,2)),s=g(p+f.z*f.z,1.5)):(o=f.x*d.y-f.y*d.x,s=g(p,1.5)),0===o||0===s)return{k:0,r:0};if(a=o/s,u=s/o,!r){const r=E.curvature(t-.001,e,n,i,!0).k,o=E.curvature(t+.001,e,n,i,!0).k;l=(o-a+(a-r))/2,c=(h(o-a)+h(a-r))/2}return{k:a,r:u,dk:l,adk:c}},inflections:function(t){if(t.length<4)return[];const e=E.align(t,{p1:t[0],p2:t.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,r=e[1].x*e[2].y,o=18*(-3*n+2*i+3*r-e[3].x*e[2].y),s=18*(3*n-i-3*r),c=18*(r-n);if(E.approximately(o,0)){if(!E.approximately(s,0)){let t=-c/s;if(0<=t&&t<=1)return[t]}return[]}const l=s*s-4*o*c,a=Math.sqrt(l),u=2*o;return E.approximately(u,0)?[]:[(a-s)/u,-(s+a)/u].filter((function(t){return 0<=t&&t<=1}))},bboxoverlap:function(t,e){const n=["x","y"],i=n.length;for(let r,o,s,c,l=0;l<i;l++)if(r=n[l],o=t[r].mid,s=e[r].mid,c=(t[r].size+e[r].size)/2,h(o-s)>=c)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,n){const i=t.bbox(),r=e.bbox(),o=1e5,s=n||.5;if(i.x.size+i.y.size<s&&r.x.size+r.y.size<s)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let c=t.split(.5),l=e.split(.5),a=[{left:c.left,right:l.left},{left:c.left,right:l.right},{left:c.right,right:l.right},{left:c.right,right:l.left}];a=a.filter((function(t){return E.bboxoverlap(t.left.bbox(),t.right.bbox())}));let u=[];return 0===a.length||(a.forEach((function(t){u=u.concat(E.pairiteration(t.left,t.right,s))})),u=u.filter((function(t,e){return u.indexOf(t)===e}))),u},getccenter:function(t,e,n){const i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y,c=i*f(w)-r*d(w),l=i*d(w)+r*f(w),a=o*f(w)-s*d(w),u=o*d(w)+s*f(w),h=(t.x+e.x)/2,p=(t.y+e.y)/2,y=(e.x+n.x)/2,g=(e.y+n.y)/2,x=h+c,v=p+l,z=y+a,_=g+u,T=E.lli8(h,p,x,v,y,g,z,_),S=E.dist(T,t);let k,A=m(t.y-T.y,t.x-T.x),C=m(e.y-T.y,e.x-T.x),j=m(n.y-T.y,n.x-T.x);return A<j?((A>C||C>j)&&(A+=b),A>j&&(k=j,j=A,A=k)):j<C&&C<A?(k=j,j=A,A=k):j+=b,T.s=A,T.e=j,T.r=S,T},numberSort:function(t,e){return t-e}};class S{constructor(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(t){return E.pointsToString(t.points)})).join(", ")+"]"}addCurve(t){this.curves.push(t),this._3d=this._3d||t._3d}length(){return this.curves.map((function(t){return t.length()})).reduce((function(t,e){return t+e}))}curve(t){return this.curves[t]}bbox(){const t=this.curves;for(var e=t[0].bbox(),n=1;n<t.length;n++)E.expandbox(e,t[n].bbox());return e}offset(t){const e=[];return this.curves.forEach((function(n){e.push(...n.offset(t))})),new S(e)}}const{abs:k,min:A,max:C,cos:j,sin:L,acos:M,sqrt:I}=Math,O=Math.PI;class D{constructor(t){let e=t&&t.forEach?t:Array.from(arguments).slice(),n=!1;if("object"==typeof e[0]){n=e.length;const t=[];e.forEach((function(e){["x","y","z"].forEach((function(n){void 0!==e[n]&&t.push(e[n])}))})),e=t}let i=!1;const r=e.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");i=!0}}else if(6!==r&&8!==r&&9!==r&&12!==r&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!i&&(9===r||12===r)||t&&t[0]&&void 0!==t[0].z,s=this.points=[];for(let t=0,n=o?3:2;t<r;t+=n){var c={x:e[t],y:e[t+1]};o&&(c.z=e[t+2]),s.push(c)}const l=this.order=s.length-1,a=this.dims=["x","y"];o&&a.push("z"),this.dimlen=a.length;const u=E.align(s,{p1:s[0],p2:s[l]});this._linear=!u.some((t=>k(t.y)>1e-4)),this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(t,e,n,i){if(void 0===i&&(i=.5),0===i)return new D(e,e,n);if(1===i)return new D(t,e,e);const r=D.getABC(2,t,e,n,i);return new D(t,r.A,n)}static cubicFromPoints(t,e,n,i,r){void 0===i&&(i=.5);const o=D.getABC(3,t,e,n,i);void 0===r&&(r=E.dist(e,o.C));const s=r*(1-i)/i,c=E.dist(t,n),l=(n.x-t.x)/c,a=(n.y-t.y)/c,u=r*l,h=r*a,f=s*l,d=s*a,p=e.x-u,m=e.y-h,y=e.x+f,g=e.y+d,x=o.A,v=x.x+(p-x.x)/(1-i),b=x.y+(m-x.y)/(1-i),w=x.x+(y-x.x)/i,z=x.y+(g-x.y)/i,_={x:t.x+(v-t.x)/i,y:t.y+(b-t.y)/i},T={x:n.x+(w-n.x)/(1-i),y:n.y+(z-n.y)/(1-i)};return new D(t,_,T,n)}static getUtils(){return E}getUtils(){return D.getUtils()}static get PolyBezier(){return S}valueOf(){return this.toString()}toString(){return E.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const t=this.points,e=["M",t[0].x,t[0].y,2===this.order?"Q":"C"];for(let n=1,i=t.length;n<i;n++)e.push(t[n].x),e.push(t[n].y);return e.join(" ")}setRatios(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]}verify(){const t=this.coordDigest();t!==this._print&&(this._print=t,this.update())}coordDigest(){return this.points.map((function(t,e){return""+e+t.x+t.y+(t.z?t.z:0)})).join("")}update(){this._lut=[],this.dpoints=E.derive(this.points,this._3d),this.computedirection()}computedirection(){const t=this.points,e=E.angle(t[0],t[this.order],t[1]);this.clockwise=e>0}length(){return E.length(this.derivative.bind(this))}static getABC(t=2,e,n,i,r=.5){const o=E.projectionratio(r,t),s=1-o,c={x:o*e.x+s*i.x,y:o*e.y+s*i.y},l=E.abcratio(r,t);return{A:{x:n.x+(n.x-c.x)/l,y:n.y+(n.y-c.y)/l},B:n,C:c,S:e,E:i}}getABC(t,e){e=e||this.get(t);let n=this.points[0],i=this.points[this.order];return D.getABC(this.order,n,e,i,t)}getLUT(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(let e,n,i=0;i<t;i++)n=i/(t-1),e=this.compute(n),e.t=n,this._lut.push(e);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),r=[];for(let t,o=0,s=0;o<i.length;o++)t=i[o],E.dist(t,e)<n&&(r.push(t),s+=o/i.length);return!!r.length&&(t/=r.length)}project(t){const e=this.getLUT(),n=e.length-1,i=E.closest(e,t),r=i.mpos,o=(r-1)/n,s=(r+1)/n,c=.1/n;let l,a,u=i.mdist,h=o,f=h;for(u+=1;h<s+c;h+=c)l=this.compute(h),a=E.dist(t,l),a<u&&(u=a,f=h);return f=f<0?0:f>1?1:f,l=this.compute(f),l.t=f,l.d=u,l}get(t){return this.compute(t)}point(t){return this.points[t]}compute(t){return this.ratios?E.computeWithRatios(t,this.points,this.ratios,this._3d):E.compute(t,this.points,this._3d,this.ratios)}raise(){const t=this.points,e=[t[0]],n=t.length;for(let i,r,o=1;o<n;o++)i=t[o],r=t[o-1],e[o]={x:(n-o)/n*i.x+o/n*r.x,y:(n-o)/n*i.y+o/n*r.y};return e[n]=t[n-1],new D(e)}derivative(t){return E.compute(t,this.dpoints[0],this._3d)}dderivative(t){return E.compute(t,this.dpoints[1],this._3d)}align(){let t=this.points;return new D(E.align(t,{p1:t[0],p2:t[t.length-1]}))}curvature(t){return E.curvature(t,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return E.inflections(this.points)}normal(t){return this._3d?this.__normal3(t):this.__normal2(t)}__normal2(t){const e=this.derivative(t),n=I(e.x*e.x+e.y*e.y);return{x:-e.y/n,y:e.x/n}}__normal3(t){const e=this.derivative(t),n=this.derivative(t+.01),i=I(e.x*e.x+e.y*e.y+e.z*e.z),r=I(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=i,e.y/=i,e.z/=i,n.x/=r,n.y/=r,n.z/=r;const o={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},s=I(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;const c=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:c[0]*e.x+c[1]*e.y+c[2]*e.z,y:c[3]*e.x+c[4]*e.y+c[5]*e.z,z:c[6]*e.x+c[7]*e.y+c[8]*e.z}}hull(t){let e=this.points,n=[],i=[],r=0;for(i[r++]=e[0],i[r++]=e[1],i[r++]=e[2],3===this.order&&(i[r++]=e[3]);e.length>1;){n=[];for(let o,s=0,c=e.length-1;s<c;s++)o=E.lerp(t,e[s],e[s+1]),i[r++]=o,n.push(o);e=n}return i}split(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;const n=this.hull(t),i={left:2===this.order?new D([n[0],n[3],n[5]]):new D([n[0],n[4],n[7],n[9]]),right:2===this.order?new D([n[5],n[4],n[2]]):new D([n[9],n[8],n[6],n[3]]),span:n};return i.left._t1=E.map(0,0,1,this._t1,this._t2),i.left._t2=E.map(t,0,1,this._t1,this._t2),i.right._t1=E.map(t,0,1,this._t1,this._t2),i.right._t2=E.map(1,0,1,this._t1,this._t2),e?(e=E.map(e,t,1,0,1),i.right.split(e).left):i}extrema(){const t={};let e=[];return this.dims.forEach(function(n){let i=function(t){return t[n]},r=this.dpoints[0].map(i);t[n]=E.droots(r),3===this.order&&(r=this.dpoints[1].map(i),t[n]=t[n].concat(E.droots(r))),t[n]=t[n].filter((function(t){return t>=0&&t<=1})),e=e.concat(t[n].sort(E.numberSort))}.bind(this)),t.values=e.sort(E.numberSort).filter((function(t,n){return e.indexOf(t)===n})),t}bbox(){const t=this.extrema(),e={};return this.dims.forEach(function(n){e[n]=E.getminmax(this,n,t[n])}.bind(this)),e}overlaps(t){const e=this.bbox(),n=t.bbox();return E.bboxoverlap(e,n)}offset(t,e){if(void 0!==e){const n=this.get(t),i=this.normal(t),r={c:n,n:i,x:n.x+i.x*e,y:n.y+i.y*e};return this._3d&&(r.z=n.z+i.z*e),r}if(this._linear){const e=this.normal(0),n=this.points.map((function(n){const i={x:n.x+t*e.x,y:n.y+t*e.y};return n.z&&e.z&&(i.z=n.z+t*e.z),i}));return[new D(n)]}return this.reduce().map((function(e){return e._linear?e.offset(t)[0]:e.scale(t)}))}simple(){if(3===this.order){const t=E.angle(this.points[0],this.points[3],this.points[1]),e=E.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&e<0||t<0&&e>0)return!1}const t=this.normal(0),e=this.normal(1);let n=t.x*e.x+t.y*e.y;return this._3d&&(n+=t.z*e.z),k(M(n))<O/3}reduce(){let t,e,n=0,i=0,r=.01,o=[],s=[],c=this.extrema().values;for(-1===c.indexOf(0)&&(c=[0].concat(c)),-1===c.indexOf(1)&&c.push(1),n=c[0],t=1;t<c.length;t++)i=c[t],e=this.split(n,i),e._t1=n,e._t2=i,o.push(e),n=i;return o.forEach((function(t){for(n=0,i=0;i<=1;)for(i=n+r;i<=1.01;i+=r)if(e=t.split(n,i),!e.simple()){if(i-=r,k(n-i)<r)return[];e=t.split(n,i),e._t1=E.map(n,0,1,t._t1,t._t2),e._t2=E.map(i,0,1,t._t1,t._t2),s.push(e),n=i;break}n<1&&(e=t.split(n,1),e._t1=E.map(n,0,1,t._t1,t._t2),e._t2=t._t2,s.push(e))})),s}scale(t){const e=this.order;let n=!1;if("function"==typeof t&&(n=t),n&&2===e)return this.raise().scale(n);const i=this.clockwise,r=n?n(0):t,o=n?n(1):t,s=[this.offset(0,10),this.offset(1,10)],c=this.points,l=[],a=E.lli4(s[0],s[0].c,s[1],s[1].c);if(!a)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(t){const n=l[t*e]=E.copy(c[t*e]);n.x+=(t?o:r)*s[t].n.x,n.y+=(t?o:r)*s[t].n.y})),n?([0,1].forEach((function(r){if(2!==e||!r){var o=c[r+1],s={x:o.x-a.x,y:o.y-a.y},u=n?n((r+1)/e):t;n&&!i&&(u=-u);var h=I(s.x*s.x+s.y*s.y);s.x/=h,s.y/=h,l[r+1]={x:o.x+u*s.x,y:o.y+u*s.y}}})),new D(l)):([0,1].forEach((t=>{if(2===e&&t)return;const n=l[t*e],i=this.derivative(t),r={x:n.x+i.x,y:n.y+i.y};l[t+1]=E.lli4(n,r,a,c[t+1])})),new D(l))}outline(t,e,n,i){e=void 0===e?t:e;const r=this.reduce(),o=r.length,s=[];let c,l=[],a=0,u=this.length();const h=void 0!==n&&void 0!==i;function f(t,e,n,i,r){return function(o){const s=i/n,c=(i+r)/n,l=e-t;return E.map(o,0,1,t+s*l,t+c*l)}}r.forEach((function(r){const o=r.length();h?(s.push(r.scale(f(t,n,u,a,o))),l.push(r.scale(f(-e,-i,u,a,o)))):(s.push(r.scale(t)),l.push(r.scale(-e))),a+=o})),l=l.map((function(t){return c=t.points,c[3]?t.points=[c[3],c[2],c[1],c[0]]:t.points=[c[2],c[1],c[0]],t})).reverse();const d=s[0].points[0],p=s[o-1].points[s[o-1].points.length-1],m=l[o-1].points[l[o-1].points.length-1],y=l[0].points[0],g=E.makeline(m,d),x=E.makeline(p,y),v=[g].concat(s).concat([x]).concat(l);return v.length,new S(v)}outlineshapes(t,e,n){e=e||t;const i=this.outline(t,e).curves,r=[];for(let t=1,e=i.length;t<e/2;t++){const o=E.makeshape(i[t],i[e-t],n);o.startcap.virtual=t>1,o.endcap.virtual=t<e/2-1,r.push(o)}return r}intersects(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof D&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)}lineIntersects(t){const e=A(t.p1.x,t.p2.x),n=A(t.p1.y,t.p2.y),i=C(t.p1.x,t.p2.x),r=C(t.p1.y,t.p2.y);return E.roots(this.points,t).filter((t=>{var o=this.get(t);return E.between(o.x,e,i)&&E.between(o.y,n,r)}))}selfintersects(t){const e=this.reduce(),n=e.length-2,i=[];for(let r,o,s,c=0;c<n;c++)o=e.slice(c,c+1),s=e.slice(c+2),r=this.curveintersects(o,s,t),i.push(...r);return i}curveintersects(t,e,n){const i=[];t.forEach((function(t){e.forEach((function(e){t.overlaps(e)&&i.push({left:t,right:e})}))}));let r=[];return i.forEach((function(t){const e=E.pairiteration(t.left,t.right,n);e.length>0&&(r=r.concat(e))})),r}arcs(t){return t=t||.5,this._iterate(t,[])}_error(t,e,n,i){const r=(i-n)/4,o=this.get(n+r),s=this.get(i-r),c=E.dist(t,e),l=E.dist(t,o),a=E.dist(t,s);return k(l-c)+k(a-c)}_iterate(t,e){let n,i=0,r=1;do{n=0,r=1;let o,s,c,l,a,u=this.get(i),h=!1,f=!1,d=r,p=1,m=0;do{if(f=h,l=c,d=(i+r)/2,m++,o=this.get(d),s=this.get(r),c=E.getccenter(u,o,s),c.interval={start:i,end:r},h=this._error(c,u,i,r)<=t,a=f&&!h,a||(p=r),h){if(r>=1){if(c.interval.end=p=1,l=c,r>1){let t={x:c.x+c.r*j(c.e),y:c.y+c.r*L(c.e)};c.e+=E.angle({x:c.x,y:c.y},t,this.get(1))}break}r+=(r-i)/2}else r=d}while(!a&&n++<100);if(n>=100)break;l=l||c,e.push(l),i=p}while(r<1);return e}}const N=.04,W=.16;function U(t){if("number"==typeof t&&isFinite(t))return{row:t,column:t};if("string"==typeof t){let[e,n]=t.split(/\s+/,2).map(Number);return isFinite(e)||(e=2.4),isFinite(n)||(n=1.8),{row:n,column:e}}return{row:1.8,column:2.4}}function B(t,e,n){if("number"==typeof t&&isFinite(t))return{row:n.row,column:n.column+t};if("string"!=typeof t)return"from"===e?{row:n.row,column:n.column}:{row:n.row,column:n.column+1};const[i,r]=t.split(/\s+/,2).map((t=>Number(t??0)));return isFinite(i)&&isFinite(r)?{row:n.row+r,column:n.column+i}:t}function F(t){if("number"==typeof t&&isFinite(t))return{angle:t,strength:1};if("string"!=typeof t)return;let[e,n]=t.split(/\s+/,2).map(Number);return isFinite(e)||(e=0),isFinite(n)||(n=1),{angle:e,strength:n}}function q(t){return"number"==typeof t&&isFinite(t)?t:!0===t?.24:0}function $(t){return"two"===t?t:"one"}function P(t,e,n){return"none"===t?t:"bar"===t?"two"===n?"Bar":t:"harpoon"===t||"harpoon-"===t||"hook"===t||"hook-"===t||"two"===t||"tail"===t?"two"===n?"none":t:"tail"===e?"none":"two"===n?"Arrow":"arrow"}function R(t,e){const i=[],r={tag:"katex"===t.tag?t.tag:"div",options:{},children:[]};for(const s of t.children){if(0===s.length){r.children.push(s);continue}const t=s[0];if("string"==typeof t){r.children.push(s);continue}let{at:c,shift:l}=t.options;if(void 0===c&&void 0===l)r.children.push(s);else{("number"!=typeof c||c<0||c>1)&&(c=.5),"number"==typeof l&&isFinite(l)||(l=.6);let r=t.options["cd-id"];"string"!=typeof r&&(r=n(t.children)),r=o(r);const s=e[r]=(e[r]??0)+1,a=s>1||0===r.length?`${r}~${s}`:r;i.push({at:c,shift:l,unit:t,id:a})}}let s=t.options["cd-id"];if("string"!=typeof s&&(s=n(r.children)),s=o(s),r.children.length>0||s.length>0){const t=e[s]=(e[s]??0)+1,n=t>1||0===s.length?`${s}~${t}`:s;i.push({at:.5,shift:.6,unit:r,id:n})}return i}function H(t){return{x:Math.cos(t/180*Math.PI),y:-Math.sin(t/180*Math.PI)}}function G(t){const e=Math.acos(t.x)/Math.PI*180;return t.y<=0?e:360-e}function V(t,e,n){if((t%=360)<0&&(t+=360),0===t)return{x:e.x+n.width/2,y:e.y};if(180===t)return{x:e.x-n.width/2,y:e.y};if(90===t)return{x:e.x,y:e.y-n.height/2};if(270===t)return{x:e.x,y:e.y+n.height/2};const i=Math.abs(Math.tan(t/180*Math.PI)),r=Math.min(n.width,n.height/i)/2,o=Math.min(n.height,n.width*i)/2;return t<90?{x:e.x+r,y:e.y-o}:t<180?{x:e.x-r,y:e.y-o}:t<270?{x:e.x-r,y:e.y+o}:{x:e.x+r,y:e.y+o}}const J=[5.4,6.5,4.8,3,2,1,0,0],Z=[4.5,7.5,3,4.5,-1.5,1,-4.5,0],K=[0,0,-6,0,-6,-5,0,-5],Y=[0,5,0,0,0,-5],Q=[0,7.5,0,0,0,-7.5];function X(t,e,n){function i(...t){const i=[],r=Math.floor(t.length/2);for(let s=0;s<r;s++){const r=2*s,{x:c,y:l}=(o={x:t[r],y:t[r+1]},{x:n.x+o.x*N*e.x-o.y*N*e.y,y:n.y+o.y*N*e.x+o.x*N*e.y});i.push(c,l)}var o;return i}switch(t){case"harpoon":return[new D(i(...J))];case"harpoon-":return[new D(i(...J.map(((t,e)=>e%2==0?t:-t))))];case"arrow":return[new D(i(...J)),new D(i(...J.map(((t,e)=>e%2==0?t:-t))))];case"Arrow":return[new D(i(...Z)),new D(i(...Z.map(((t,e)=>e%2==0?t:-t))))];case"tail":return[new D(i(...J.map(((t,e)=>e%2==0?-t:t)))),new D(i(...J.map((t=>-t))))];case"two":return[new D(i(...J)),new D(i(...J.map(((t,e)=>e%2==0?t:-t)))),new D(i(...J.map(((t,e)=>e%2==0?t-4.5:t)))),new D(i(...J.map(((t,e)=>e%2==0?t-4.5:-t))))];case"hook":return[new D(i(...K))];case"hook-":return[new D(i(...K.map(((t,e)=>e%2==0?t:-t))))];case"bar":return[new D(i(...Y))];case"Bar":return[new D(i(...Q))];case"none":return[]}}function tt(t,e){t.style.left=e.x+"em",t.style.top=e.y+"em",t.style.height="0",t.style.width="0",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center"}function et(t,e){const n=document.createElement("div"),i=document.createElement("div");return n.style.position="absolute",e.append(n),n.append(i),i.append(t),n}const nt=async(t,e)=>{const i=U(t.options.gap),r=document.createElement("div"),s=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.position="relative",s.style.position="absolute",s.style.display="block",r.append(s);let c={children:[],id:""},l=[c];const a=[l],u=[],h={};for(const e of t.children)if(0!==e.length){{const t=e[0];if("string"!=typeof t){if("ar"===t.tag||"katex"===t.tag&&!0===t.options.ar){const e={row:a.length-1,column:l.length-1},n=$(t.options.body),i=R(t,h);u.push({from:B(t.options.from,"from",e),to:B(t.options.to,"to",e),out:F(t.options.out),in:F(t.options.in),shift:q(t.options.shift),body:n,head:P(t.options.head,"head",n),tail:P(t.options.tail,"tail",n),labels:i,class:"string"==typeof t.options.class?t.options.class:"",style:"string"==typeof t.options.style?t.options.style:""});continue}}else{if("&"===t&&1===e.length){l.push(c={children:[],id:""});continue}if("\\"===t&&2===e.length&&"\\"===e[1]){a.push(l=[c={children:[],id:""}]);continue}}}if(c.children.push(e),0===c.id.length){const t=o(n([e]));if(0===t.length)continue;const i=h[t]=(h[t]??0)+1,r=i>1||0===t.length?`${t}~${i}`:t;c.id=r}}else c.children.push(e);const f={},d=[];for(let t=0;t<a.length;t++){const n=a[t];for(let i=0;i<n.length;i++){const{children:o,id:s}=n[i];0!==o.length&&(d.push({element:et(await e.compileSTDN(o),r),position:{row:t,column:i},id:s}),s.length>0&&(f[s]=!0))}}const p={},m=[];let y=u;for(;;){const t=[];for(const n of y){const{from:i,to:o}=n;if("string"!=typeof i||f[i])if("string"!=typeof o||f[o]){m.push(n);for(const{unit:t,id:i}of n.labels){const n=et(await e.compileUnit(t),r);n.classList.add("label"),p[i]=n,f[i]=!0}}else t.push(n);else t.push(n)}if(y.length===t.length)break;y=t}function g(){s.innerHTML="";const t=[],e=[],n=Number(getComputedStyle(r).fontSize.slice(0,-2));let o=1/n,c=1/n;const l=r.closest("foreignObject");if(null!==l){const{height:t,width:e}=l.getBoundingClientRect();o*=l.height.animVal.value/t,c*=l.width.animVal.value/e}const a={},u={};for(const{element:n,position:i,id:r}of d){const{height:s,width:l}=n.children[0].getBoundingClientRect(),h=s*o+1,f=l*c+1,d={height:h,width:f};a[i.row+" "+i.column]=d,r.length>0&&(u[r]=d),(t[i.row]??0)<h&&(t[i.row]=h),(e[i.column]??0)<f&&(e[i.column]=f)}function h(n){let r=(e[0]??0)/2,o=(t[0]??0)/2;for(let t=1;t<=n.column;t++){const n=e[t-1],o=e[t];void 0!==n&&(r+=n/2,void 0!==o&&(r+=i.column)),void 0!==o&&(r+=o/2)}if(n.column%1!=0){const t=Math.floor(n.column),o=e[t],s=e[t+1];void 0!==o&&(r+=(n.column-t)*o/2,void 0!==s&&(r+=(n.column-t)*i.column)),void 0!==s&&(r+=(n.column-t)*s/2)}for(let e=1;e<=n.row;e++){const n=t[e-1],r=t[e];void 0!==n&&(o+=n/2,void 0!==r&&(o+=i.row)),void 0!==r&&(o+=r/2)}if(n.row%1!=0){const e=Math.floor(n.row),r=t[e],s=t[e+1];void 0!==r&&(o+=(n.row-e)*r/2,void 0!==s&&(o+=(n.row-e)*i.row)),void 0!==s&&(o+=(n.row-e)*s/2)}return{x:r,y:o}}const f={};for(const{element:t,position:e,id:n}of d){const i=h(e);n.length>0&&(f[n]=i),tt(t,i)}let y=0,g=0,x=h({row:0,column:e.length}).x,v=h({row:t.length,column:0}).y;function b(t,e,n){const i=t.offset(-e);Array.isArray(i)&&w(i,n)}function w(t,e){const n=[];for(const e of t){n.push(e.toSVG());const{x:t,y:i}=e.bbox(),r=t.min-N,o=t.max+N,s=i.min-N,c=i.max+N;r<y&&(y=r),o>x&&(x=o),s<g&&(g=s),c>v&&(v=c)}const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",n.join(" ")),i.style.strokeWidth="0.04px",i.style.fill="none",e.append(i)}for(const{from:t,to:e,out:n,in:i,head:r,tail:l,shift:d,body:y,class:g,style:x,labels:v}of m){let m,z,_,T,E,S,k,A,C,j;if("string"!=typeof t){m=h(t);const e=a[t.row+" "+t.column];_=void 0===e?{height:0,width:0}:e}else{const e=f[t],n=u[t];if(void 0===e||void 0===n)continue;m=e,_=n}if("string"!=typeof e){z=h(e);const t=a[e.row+" "+e.column];T=void 0===t?{height:0,width:0}:t}else{const t=f[e],n=u[e];if(void 0===t||void 0===n)continue;z=t,T=n}if(void 0===n||void 0===i){const t=z.x-m.x,e=z.y-m.y,r=Math.sqrt(t**2+e**2);if(0===r)continue;const o={x:t/r,y:e/r},s=G(o);void 0===n?(E=V(s,m,_),k=o,C=1):(E=V(n.angle,m,_),k=H(n.angle),C=n.strength),void 0===i?(S=V(s+180,z,T),A={x:-o.x,y:-o.y},j=1):(S=V(i.angle,z,T),A=H(i.angle),j=i.strength)}else E=V(n.angle,m,_),S=V(i.angle,z,T),k=H(n.angle),A=H(i.angle),C=n.strength,j=i.strength;"Arrow"!==r&&"hook"!==r&&"hook-"!==r&&"tail"!==r||(E.x=E.x+k.x*W,E.y=E.y+k.y*W),"Arrow"!==l&&"hook"!==l&&"hook-"!==l&&"tail"!==l||(S.x=S.x+A.x*W,S.y=S.y+A.y*W);const L=Math.sqrt((S.x-E.x)**2+(S.y-E.y)**2);if(0===L)continue;const M={x:E.x+k.x*L/3*C,y:E.y+k.y*L/3*C},I={x:S.x+A.x*L/3*j,y:S.y+A.y*L/3*j},O=new D(E.x,E.y,M.x,M.y,I.x,I.y,S.x,S.y),N=document.createElementNS("http://www.w3.org/2000/svg","g");try{N.setAttribute("class",g)}catch(t){console.log(t)}try{N.setAttribute("style",x)}catch(t){console.log(t)}s.append(N),"two"===y?(b(O,d+.1,N),b(O,d-.1,N)):b(O,d,N);{const t=X(r,A,{x:S.x-A.y*d,y:S.y+A.x*d});t.length>0&&w(t,N)}{const t=X(l,k,{x:E.x+k.y*d,y:E.y-k.x*d});t.length>0&&w(t,N)}for(const{at:t,shift:e,id:n}of v){const i=O.get(t),r=O.normal(t);let s=d+e;"two"===y&&0!==e&&(s+=.1*Math.sign(e));const l={x:i.x-r.x*s,y:i.y-r.y*s};f[n]=l;const a=p[n];if(void 0===a)throw new Error;tt(a,l);const{height:h,width:m}=a.children[0].getBoundingClientRect(),g={height:h*o+.6,width:m*c+.6};u[n]=g}}const z=x-y,_=v-g;return r.style.marginLeft=-y+"em",r.style.marginTop=-g+"em",r.style.width=x+"em",r.style.height=v+"em",s.setAttribute("viewBox",`${y} ${g} ${z} ${_}`),s.style.left=y+"em",s.style.top=g+"em",s.style.width=z+"em",s.style.height=_+"em",s.innerHTML}const x=new MutationObserver((async()=>{if(!r.isConnected)return;let t;x.disconnect();let e=0;for(;;){const n=g();if(n===t&&(e++,1===e))break;t=n,console.log("test"),await new Promise((t=>setTimeout(t,1e3)))}}));return x.observe(document.body,{childList:!0,subtree:!0}),r}})();var o=r.aC,s=r.cd,c=r.Zg,l=r.Co,a=r.rY,u=r.T_,h=r.in,f=r.vi,d=r.vy,p=r.Im,m=r.D8,y=r.xA,g=r.li,x=r.$_;export{o as angleToD,s as cd,c as createArrowMark,l as createCenteredElement,a as dToAngle,u as extractLabels,h as getEdgePoint,f as parseArrowBody,d as parseArrowMark,p as parseArrowShift,m as parseControl,y as parseGap,g as parsePosition,x as placeElement};