var e={400:(t,e,n)=>{n(650)},650:(t,e)=>{function n(t,e,n=!1){let i=0,o=!1,r=!1,s=0,c=!1,l=[];const a=[];for(let u=0;u<t.length;u++){if(!0===r){r=!1;continue}const h=t[u];if("line"!==c)if("block"!==c)if("'"!==h){if(o){if("\\"===h){r=!0;continue}}else if("{"!==h&&"["!==h)if("}"!==h&&"]"!==h){if(!(i>0))if(","!==h&&"\n"!==h){if(!(s<u))if(0!==h.trimEnd().length){if("/"===h){const e=t[u+1];if("/"===e){s=u,u++,c="line";continue}if("*"===e){s=u,u++,c="block";continue}}}else s=u+1}else{const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]),s=u+1}}else{if(i--,i<0){const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]);break}0===i&&(a.push({value:t.slice(s,u+1),index:e+s,comment:l.join("\n")}),l=[],s=u+1)}else if(i++,1===i&&!n){const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]),s=u}}else{if(!o){if(o=!0,0===i&&!n){const n=t.slice(s,u).trimEnd();n.length>0&&(a.push({value:n,index:e+s,comment:l.join("\n")}),l=[]),s=u}continue}o=!1,0===i&&(a.push({value:t.slice(s,u+1),index:e+s,comment:l.join("\n")}),l=[],s=u+1)}else"*"===h&&"/"===t[u+1]&&(u++,c=!1,l.push(t.slice(s,u+1).replace(/\n[ ]*/g,"\n ")),s=u+1);else"\n"===h&&(c=!1,l.push(t.slice(s,u).trimEnd()),s=u+1)}if(!o&&0===i&&!1===c){const n=t.slice(s).trimEnd();n.length>0&&a.push({value:n,index:e+s,comment:l.join("\n")})}return a}function i(t,e=!1){let n=0,i=!1,o=!1,r=0,s=!1;const c=[];for(let l=0;l<t.length;l++){if(!0===o){o=!1;continue}const a=t[l];if("line"!==s)if("block"!==s)if("'"!==a){if(i){if("\\"===a){o=!0;continue}}else if("{"!==a&&"["!==a)if("}"!==a&&"]"!==a){if(!(n>0))if(","!==a&&"\n"!==a){if(!(r<l))if(0!==a.trimEnd().length){if("/"===a){const e=t[l+1];if("/"===e){l++,s="line",r=l+1;continue}if("*"===e){l++,s="block",r=l+1;continue}}}else r=l+1}else{const e=t.slice(r,l).trimEnd();e.length>0&&c.push(e),r=l+1}}else{if(n--,n<0){const e=t.slice(r,l).trimEnd();e.length>0&&c.push(e);break}0===n&&(c.push(t.slice(r,l+1)),r=l+1)}else if(n++,1===n&&!e){const e=t.slice(r,l).trimEnd();e.length>0&&c.push(e),r=l}}else{if(!i){if(i=!0,0===n&&!e){const e=t.slice(r,l).trimEnd();e.length>0&&c.push(e),r=l}continue}i=!1,0===n&&(c.push(t.slice(r,l+1)),r=l+1)}else"*"===a&&"/"===t[l+1]&&(l++,s=!1),r=l+1;else"\n"===a&&(s=!1),r=l+1}if(!i&&0===n){const e=t.slice(r).trimEnd();e.length>0&&c.push(e)}return c}function o(t){const e=[];let n=!1;for(const i of t)if(!0!==n)if("\\"!==i){if("'"===i)break;e.push(i)}else n=!0;else n=!1,"\\"!==i&&"'"!==i&&e.push("\\"),e.push(i);return e.join("")}function r(t,e=0,i=""){e+=t.length;const s=function(t,e){if(0===t.length)return;const i=t[0];return"'"===i?o(t.slice(1)):"["===i?function(t,e){return function(t){const e=[];for(const{value:n,index:i,comment:o}of t){const t=r(n,i,o);if(void 0===t)return;e.push(t)}return e}(n(t,e))}(t.slice(1),e+1):"{"===i?function(t,e){return function(t){const e={};for(const{value:n,index:i,comment:o}of t){const t=n.match(/^\s*([\w-]+)/);if(null===t){const t=r(n,i,o);if(void 0===t)return;e.__=t;continue}const s=t[1],c=t[0].length;let l=n.slice(c).trimEnd();if(0===l.length)e[s]={value:!0,index:i+c,comment:o};else{const t=r(l,i+c,o);if(void 0===t)return;e[s]=t}}return e}(n(t,e,!0))}(t.slice(1),e+1):"true"===(t=t.trimEnd())||"false"!==t&&(/^(?:[+-]?Infinity|NaN|0x[\da-fA-F]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(t)?Number(t):/[',{}\[\]\n\r]/.test(t)?void 0:t)}(t=t.trimStart(),e-=t.length);if(void 0!==s)return{value:s,index:e,comment:i}}function s(t){if(0===(t=t.trimStart()).length)return;const e=t[0];return"'"===e?o(t.slice(1)):"["===e?function(t){return function(t){const e=[];for(const n of t){const t=s(n);if(void 0===t)return;e.push(t)}return e}(i(t))}(t.slice(1)):"{"===e?function(t){return function(t){const e={};for(const n of t){const t=n.match(/^\s*([\w-]+)/);if(null===t){const t=s(n);if(void 0===t)return;e.__=t;continue}const i=t[1],o=t[0].length;let r=n.slice(o).trimEnd();if(0===r.length)e[i]=!0;else{const t=s(r);if(void 0===t)return;e[i]=t}}return e}(i(t,!0))}(t.slice(1)):"true"===(t=t.trimEnd())||"false"!==t&&(/^(?:[+-]?Infinity|NaN|0x[\da-fA-F]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(t)?Number(t):/[',{}\[\]\n\r]/.test(t)?void 0:t)}function c(t,e){if(e&&t.length>0&&t[0].trim().length>0&&(1===t.length||t[t.length-1].trim().length>0)&&!/[',{}\[\]\n\r]/.test(t)&&"true"!==t&&"false"!==t&&!/^(?:[+-]?Infinity|NaN|0x[\da-fA-F]+|0o[0-7]+|0b[01]+|[+-]?(?:\d*\.?\d+|\d+\.)(?:e[+-]?\d+)?)$/.test(t)&&!t.startsWith("//")&&!t.startsWith("/*"))return t;const n=["'"];for(let e=0;e<t.length;e++){const i=t[e];if("\\"!==i)"'"!==i?n.push(i):n.push("\\'");else{if(e===t.length-1){n.push("\\\\");break}const o=t[e+1];if("\\"===o||"'"===o){n.push("\\\\");continue}n.push(i)}}return n.push("'"),n.join("")}Object.defineProperty(e,"__esModule",{value:!0}),e.stringify=e.stringifyWithComment=e.parse=e.parseWithIndex=void 0,e.parseWithIndex=r,e.parse=s,e.stringifyWithComment=function t(e,n={}){return void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?c(e,n.useUnquotedString):!0===e?"true":!1===e?"false":Array.isArray(e)?function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s}){n=n??"none",i=i??0,o=o??"never";const c=[],l=e.length>1&&("all"===n||"array"===n||"arrayInObjectAndThis"===n)||void 0!==e.find((t=>t.comment.length>0)),a=i+(l?1:0);"arrayInObjectAndThis"===n&&(n="arrayInObject");const u="always"===r||"afterComma"===r?", ":",";let h;for(let i=0;i<e.length;i++){const{value:f,comment:d}=e[i];let p;p=void 0===h?t(f,{indentTarget:n,indentLevel:a,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s}):h,i!==e.length-1&&(h=t(e[i+1].value,{indentTarget:n,indentLevel:a,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s})),l||i===e.length-1||"always"!==o&&(p.endsWith("'")||p.endsWith("}")||p.endsWith("]")||void 0!==h&&(h.endsWith("'")||h.endsWith("}")||h.endsWith("]")))?(d.length>0&&c.push(...d.split("\n")),c.push(p)):c.push(p+u)}let f="\n";for(let t=0;t<i;t++)f+="    ";let d=f;return i>=0&&(d+="    "),l?"["+d+c.join(d)+f+"]":"["+c.join("")+"]"}(e,n):function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s}){n=n??"none",i=i??0,o=o??"never";const c=[],l=Object.keys(e);let a=l.length>1&&("all"===n||"object"===n);if(!a)for(const t of l){const n=e[t];if(void 0!==n&&n.comment.length>0){a=!0;break}}const u=i+(a?1:0);"arrayInObject"===n&&(n="arrayInObjectAndThis");const h="always"===r||"afterComma"===r?", ":",",f="always"===r||"afterKey"===r?" ":"";for(let i=0;i<l.length;i++){const d=l[i];if(null===d.match(/^[\w-]+$/))continue;const p=e[d];if(void 0===p)continue;const{value:m,comment:y}=p,g=t(m,{indentTarget:n,indentLevel:u,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:"__"===d&&"string"==typeof m?void 0:s});y.length>0&&c.push(...y.split("\n")),g.startsWith("'")||g.startsWith("[")||g.startsWith("{")?a||i===l.length-1||"always"!==o&&"inObject"!==o?c.push(("__"===d?"":d+f)+g):c.push(("__"===d?"":d+f)+g+h):"true"===g?a||i===l.length-1?c.push(d):c.push(d+h):a||i===l.length-1?c.push(d+" "+g):c.push(d+" "+g+h)}let d="\n";for(let t=0;t<i;t++)d+="    ";let p=d;return i>=0&&(p+="    "),a?"{"+p+c.join(p)+d+"}":"{"+c.join("")+"}"}(e,n)},e.stringify=function t(e,n={}){return void 0===e?"":"number"==typeof e?e.toString():"string"==typeof e?c(e,n.useUnquotedString):!0===e?"true":!1===e?"false":Array.isArray(e)?function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s}){n=n??"none",i=i??0,o=o??"never";const c=[],l=e.length>1&&("all"===n||"array"===n||"arrayInObjectAndThis"===n),a=i+(l?1:0);"arrayInObjectAndThis"===n&&(n="arrayInObject");const u="always"===r||"afterComma"===r?", ":",";let h;for(let i=0;i<e.length;i++){let f;f=void 0===h?t(e[i],{indentTarget:n,indentLevel:a,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s}):h,i!==e.length-1&&(h=t(e[i+1],{indentTarget:n,indentLevel:a,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s})),l||i===e.length-1||"always"!==o&&(f.endsWith("'")||f.endsWith("}")||f.endsWith("]")||void 0!==h&&(h.endsWith("'")||h.endsWith("}")||h.endsWith("]")))?c.push(f):c.push(f+u)}let f="\n";for(let t=0;t<i;t++)f+="    ";let d=f;return i>=0&&(d+="    "),l?"["+d+c.join(d)+f+"]":"["+c.join("")+"]"}(e,n):function(e,{indentTarget:n,indentLevel:i,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:s}){n=n??"none",i=i??0,o=o??"never";const c=[],l=Object.keys(e),a=l.length>1&&("all"===n||"object"===n),u=i+(a?1:0);"arrayInObject"===n&&(n="arrayInObjectAndThis");const h="always"===r||"afterComma"===r?", ":",",f="always"===r||"afterKey"===r?" ":"";for(let i=0;i<l.length;i++){const d=l[i];if(null===d.match(/^[\w-]+$/))continue;const p=e[d];if(void 0===p)continue;const m=t(p,{indentTarget:n,indentLevel:u,addDecorativeComma:o,addDecorativeSpace:r,useUnquotedString:"__"===d&&"string"==typeof p?void 0:s});m.startsWith("'")||m.startsWith("[")||m.startsWith("{")?a||i===l.length-1||"always"!==o&&"inObject"!==o?c.push(("__"===d?"":d+f)+m):c.push(("__"===d?"":d+f)+m+h):"true"===m?a||i===l.length-1?c.push(d):c.push(d+h):a||i===l.length-1?c.push(d+" "+m):c.push(d+" "+m+h)}let d="\n";for(let t=0;t<i;t++)d+="    ";let p=d;return i>=0&&(p+="    "),a?"{"+p+c.join(p)+d+"}":"{"+c.join("")+"}"}(e,n)}}},n={};function i(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,i),r.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var o={};(()=>{function e(t,e){try{return new URL(t,e).href}catch(e){return console.log(e),t}}function n(t){if(0===t.length)return"";let e="";for(const i of t[0])e+="string"!=typeof i?n(i.children):i;return e}function r(t){return Array.from(t.slice(0,100).matchAll(/[a-zA-Z0-9]+/g)).join("-").toLowerCase()}function s(t,e,n){const i=n[e];return void 0===i?[]:i[t]??[]}i.d(o,{CD:()=>st,W7:()=>it,aC:()=>G,cd:()=>rt,ib:()=>et,Zg:()=>tt,rY:()=>V,T_:()=>H,in:()=>J,vi:()=>P,vy:()=>R,Im:()=>$,D8:()=>F,xA:()=>U,li:()=>B,$U:()=>ot,AY:()=>nt}),i(650),i(400);class c{constructor(t,e=[]){this.element=document.createElement(t),this.classList=this.element.classList,this.style=this.element.style,this.dataset=this.element.dataset,this.childNodes=this.element.childNodes,this.children=this.element.children;for(const t of e)if(t.length>0)try{this.element.classList.add(t.replace(/\s/g,"-"))}catch(t){console.log(t)}}append(...t){return this.element.append(...t.map((t=>t instanceof c?t.element:t))),this}prepend(...t){return this.element.prepend(...t.map((t=>t instanceof c?t.element:t))),this}after(...t){return this.element.after(...t.map((t=>t instanceof c?t.element:t))),this}before(...t){return this.element.before(...t.map((t=>t instanceof c?t.element:t))),this}setText(t){return this.element.textContent=t,this}setHTML(t){return this.element.innerHTML=t,this}scrollBy(t){return this.element.scrollBy(t),this}scrollIntoView(t){return this.element.scrollIntoView(t),this}getBoundingClientRect(){return this.element.getBoundingClientRect()}getClientRects(){return this.element.getClientRects()}setAttribute(t,e){try{this.element.setAttribute(t,e)}catch(t){console.log(t)}return this}removeAttribute(t){return this.element.removeAttribute(t),this}getAttribute(t){return this.element.getAttribute(t)}hasAttribute(t){return this.element.hasAttribute(t)}}class l extends c{constructor(t=[]){super("div",t)}addEventListener(t,e,n){return this.element.addEventListener(t,e,n),this}}class a extends c{constructor(t=[]){super("span",t)}addEventListener(t,e,n){return this.element.addEventListener(t,e,n),this}}class u{constructor(t){this.context=t,this.unitToCompiling=new Map}async compileUnit(t){if(!0===this.unitToCompiling.get(t))return u.createErrorElement("Loop");if("global"===t.tag||!0===t.options.global)return new l(["unit","global"]).element;this.unitToCompiling.set(t,!0);let n=t.options["compile-with"]??function(t,e,n){const i=s("compile-with",e,n);if(0!==i.length)return i[i.length-1]}(0,t.tag,this.context.tagToGlobalOptions);"string"==typeof n&&0!==n.length||(n=t.tag);const i=this.context.tagToUnitCompiler[n];let o;if(void 0!==i){try{o=await i(t,this)}catch(t){console.log(t),o=u.createErrorElement("Broken")}if(o.classList.contains("warn"))return o.classList.add("unit"),this.unitToCompiling.set(t,!1),o}else{let e;u.supportedHTMLTags.includes(n)?(o=document.createElement(n),e=u.supportedHTMLTagsWithInlineChildren.includes(n)?await this.compileInlineSTDN(t.children):await this.compileSTDN(t.children)):u.supportedSVGTags.includes(n)?(o=document.createElementNS("http://www.w3.org/2000/svg",n),e=await this.compileInlineSTDN(t.children)):(o=document.createElement("div"),e=await this.compileSTDN(t.children)),o.append(e)}o.classList.add("unit");try{o.classList.add(n),"string"==typeof t.options.class&&o.classList.add(...t.options.class.trim().split(/\s+/));for(const e of s("class",t.tag,this.context.tagToGlobalOptions))"string"==typeof e&&o.classList.add(...e.trim().split(/\s+/))}catch(t){console.log(t)}const r=this.context.unitToId.get(t);void 0!==r&&(o.id=r);for(const n of Object.keys(t.options)){if("id"===n||"class"===n)continue;let i=n;if(n.startsWith("data-")||u.supportedHTMLAttributes.includes(n)||(i=`data-${n}`),o.hasAttribute(i))continue;let r=t.options[n];if(!0===r?r="":"number"==typeof r&&(r=r.toString()),"string"==typeof r){this.context.dir.length>0&&("src"===i||"href"===i)&&(!(c=r).startsWith("#")&&!/^[a-z][a-z0-9+.-]*:/i.test(c))&&(r=e(r,this.context.dir));try{o.setAttribute(i,r)}catch(t){console.log(t)}}}var c;return this.unitToCompiling.set(t,!1),o}async compileInline(t){return"string"!=typeof t?await this.compileUnit(t):new Text(t)}async compileLine(t){const e=new DocumentFragment;for(const n of t)e.append(await this.compileInline(n));return e}async compileInlineSTDN(t){const e=new DocumentFragment;for(let n=0;n<t.length;n++)e.append(await this.compileLine(t[n])),n!==t.length-1&&e.append(new Text("\n"));return e}async compileSTDN(t){const e=new DocumentFragment;for(const n of t)e.append(new l(["st-line"]).append(await this.compileLine(n)).element);return e}static createErrorElement(t){return new a(["unit","warn"]).setText(t).element}}u.supportedHTMLTags=["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rp","rt","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","area","audio","img","map","track","video","iframe","del","ins","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],u.supportedHTMLTagsWithInlineChildren=["a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rp","rt","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","audio","img","track","video","iframe","del","ins","col","colgroup","table","tbody","tfoot","thead","tr"],u.supportedSVGTags=["animate","animateMotion","circle","ellipse","foreignObject","g","image","path","rect","svg","text","textPath","tspan"],u.supportedHTMLAttributes=["accesskey","align","allow","alt","autoplay","cite","class","cols","colspan","controls","coords","crossorigin","datetime","decoding","default","dir","download","draggable","for","headers","href","hreflang","id","kind","label","lang","loop","muted","name","open","ping","poster","preload","referrerpolicy","rel","reversed","rows","rowspan","sandbox","scope","span","spellcheck","src","srcdoc","srclang","srcset","start","style","tabindex","target","title","translate","usemap","value","attributeName","begin","d","dur","fill","keyPoints","keyTimes","path","preserveAspectRatio","repeatCount","rotate","textLength","values","viewBox","x","y"];const{abs:h,cos:f,sin:d,acos:p,atan2:m,sqrt:y,pow:g}=Math;function x(t){return t<0?-g(-t,1/3):g(t,1/3)}const v=Math.PI,b=2*v,w=v/2,z=Number.MAX_SAFE_INTEGER||9007199254740991,_=Number.MIN_SAFE_INTEGER||-9007199254740991,E={x:0,y:0,z:0},T={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){const n=e(t);let i=n.x*n.x+n.y*n.y;return void 0!==n.z&&(i+=n.z*n.z),y(i)},compute:function(t,e,n){if(0===t)return e[0].t=0,e[0];const i=e.length-1;if(1===t)return e[i].t=1,e[i];const o=1-t;let r=e;if(0===i)return e[0].t=t,e[0];if(1===i){const e={x:o*r[0].x+t*r[1].x,y:o*r[0].y+t*r[1].y,t};return n&&(e.z=o*r[0].z+t*r[1].z),e}if(i<4){let e,s,c,l=o*o,a=t*t,u=0;2===i?(r=[r[0],r[1],r[2],E],e=l,s=o*t*2,c=a):3===i&&(e=l*o,s=l*t*3,c=o*a*3,u=t*a);const h={x:e*r[0].x+s*r[1].x+c*r[2].x+u*r[3].x,y:e*r[0].y+s*r[1].y+c*r[2].y+u*r[3].y,t};return n&&(h.z=e*r[0].z+s*r[1].z+c*r[2].z+u*r[3].z),h}const s=JSON.parse(JSON.stringify(e));for(;s.length>1;){for(let e=0;e<s.length-1;e++)s[e]={x:s[e].x+(s[e+1].x-s[e].x)*t,y:s[e].y+(s[e+1].y-s[e].y)*t},void 0!==s[e].z&&(s[e]=s[e].z+(s[e+1].z-s[e].z)*t);s.splice(s.length-1,1)}return s[0].t=t,s[0]},computeWithRatios:function(t,e,n,i){const o=1-t,r=n,s=e;let c,l=r[0],a=r[1],u=r[2],h=r[3];return l*=o,a*=t,2===s.length?(c=l+a,{x:(l*s[0].x+a*s[1].x)/c,y:(l*s[0].y+a*s[1].y)/c,z:!!i&&(l*s[0].z+a*s[1].z)/c,t}):(l*=o,a*=2*o,u*=t*t,3===s.length?(c=l+a+u,{x:(l*s[0].x+a*s[1].x+u*s[2].x)/c,y:(l*s[0].y+a*s[1].y+u*s[2].y)/c,z:!!i&&(l*s[0].z+a*s[1].z+u*s[2].z)/c,t}):(l*=o,a*=1.5*o,u*=3*o,h*=t*t*t,4===s.length?(c=l+a+u+h,{x:(l*s[0].x+a*s[1].x+u*s[2].x+h*s[3].x)/c,y:(l*s[0].y+a*s[1].y+u*s[2].y+h*s[3].y)/c,z:!!i&&(l*s[0].z+a*s[1].z+u*s[2].z+h*s[3].z)/c,t}):void 0))},derive:function(t,e){const n=[];for(let i=t,o=i.length,r=o-1;o>1;o--,r--){const t=[];for(let n,o=0;o<r;o++)n={x:r*(i[o+1].x-i[o].x),y:r*(i[o+1].y-i[o].y)},e&&(n.z=r*(i[o+1].z-i[o].z)),t.push(n);n.push(t),i=t}return n},between:function(t,e,n){return e<=t&&t<=n||T.approximately(t,e)||T.approximately(t,n)},approximately:function(t,e,n){return h(t-e)<=(n||1e-6)},length:function(t){const e=T.Tvalues.length;let n=0;for(let i,o=0;o<e;o++)i=.5*T.Tvalues[o]+.5,n+=T.Cvalues[o]*T.arcfn(i,t);return.5*n},map:function(t,e,n,i,o){return i+(t-e)/(n-e)*(o-i)},lerp:function(t,e,n){const i={x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)};return void 0!==e.z&&void 0!==n.z&&(i.z=e.z+t*(n.z-e.z)),i},pointToString:function(t){let e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(T.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,n){const i=e.x-t.x,o=e.y-t.y,r=n.x-t.x,s=n.y-t.y;return m(i*s-o*r,i*r+o*s)},round:function(t,e){const n=""+t,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(t,e){const n=t.x-e.x,i=t.y-e.y;return y(n*n+i*i)},closest:function(t,e){let n,i,o=g(2,63);return t.forEach((function(t,r){i=T.dist(e,t),i<o&&(o=i,n=r)})),{mdist:o,mpos:n}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const n=g(t,e)+g(1-t,e);return h((n-1)/n)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const n=g(1-t,e);return n/(g(t,e)+n)},lli8:function(t,e,n,i,o,r,s,c){const l=(t-n)*(r-c)-(e-i)*(o-s);return 0!=l&&{x:((t*i-e*n)*(o-s)-(t-n)*(o*c-r*s))/l,y:((t*i-e*n)*(r-c)-(e-i)*(o*c-r*s))/l}},lli4:function(t,e,n,i){const o=t.x,r=t.y,s=e.x,c=e.y,l=n.x,a=n.y,u=i.x,h=i.y;return T.lli8(o,r,s,c,l,a,u,h)},lli:function(t,e){return T.lli4(t,t.c,e,e.c)},makeline:function(t,e){const n=t.x,i=t.y,o=e.x,r=e.y,s=(o-n)/3,c=(r-i)/3;return new I(n,i,n+s,i+c,n+2*s,i+2*c,o,r)},findbbox:function(t){let e=z,n=z,i=_,o=_;return t.forEach((function(t){const r=t.bbox();e>r.x.min&&(e=r.x.min),n>r.y.min&&(n=r.y.min),i<r.x.max&&(i=r.x.max),o<r.y.max&&(o=r.y.max)})),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+o)/2,max:o,size:o-n}}},shapeintersections:function(t,e,n,i,o){if(!T.bboxoverlap(e,i))return[];const r=[],s=[t.startcap,t.forward,t.back,t.endcap],c=[n.startcap,n.forward,n.back,n.endcap];return s.forEach((function(e){e.virtual||c.forEach((function(i){if(i.virtual)return;const s=e.intersects(i,o);s.length>0&&(s.c1=e,s.c2=i,s.s1=t,s.s2=n,r.push(s))}))})),r},makeshape:function(t,e,n){const i=e.points.length,o=t.points.length,r=T.makeline(e.points[i-1],t.points[0]),s=T.makeline(t.points[o-1],e.points[0]),c={startcap:r,forward:t,back:e,endcap:s,bbox:T.findbbox([r,t,e,s]),intersections:function(t){return T.shapeintersections(c,c.bbox,t,t.bbox,n)}};return c},getminmax:function(t,e,n){if(!n)return{min:0,max:0};let i,o,r=z,s=_;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(let c=0,l=n.length;c<l;c++)i=n[c],o=t.get(i),o[e]<r&&(r=o[e]),o[e]>s&&(s=o[e]);return{min:r,mid:(r+s)/2,max:s,size:s-r}},align:function(t,e){const n=e.p1.x,i=e.p1.y,o=-m(e.p2.y-i,e.p2.x-n);return t.map((function(t){return{x:(t.x-n)*f(o)-(t.y-i)*d(o),y:(t.x-n)*d(o)+(t.y-i)*f(o)}}))},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=t.length-1,i=T.align(t,e),o=function(t){return 0<=t&&t<=1};if(2===n){const t=i[0].y,e=i[1].y,n=i[2].y,r=t-2*e+n;if(0!==r){const i=-y(e*e-t*n),s=-t+e;return[-(i+s)/r,-(-i+s)/r].filter(o)}return e!==n&&0===r?[(2*e-n)/(2*e-2*n)].filter(o):[]}const r=i[0].y,s=i[1].y,c=i[2].y;let l=3*s-r-3*c+i[3].y,a=3*r-6*s+3*c,u=-3*r+3*s,h=r;if(T.approximately(l,0)){if(T.approximately(a,0))return T.approximately(u,0)?[]:[-h/u].filter(o);const t=y(u*u-4*a*h),e=2*a;return[(t-u)/e,(-u-t)/e].filter(o)}a/=l,u/=l,h/=l;const d=(3*u-a*a)/3,m=d/3,g=(2*a*a*a-9*a*u+27*h)/27,v=g/2,w=v*v+m*m*m;let z,_,E,k,A;if(w<0){const t=-d/3,e=y(t*t*t),n=-g/(2*e),i=p(n<-1?-1:n>1?1:n),r=2*x(e);return E=r*f(i/3)-a/3,k=r*f((i+b)/3)-a/3,A=r*f((i+2*b)/3)-a/3,[E,k,A].filter(o)}if(0===w)return z=v<0?x(-v):-x(v),E=2*z-a/3,k=-z-a/3,[E,k].filter(o);{const t=y(w);return z=x(-v+t),_=x(v+t),[z-_-a/3].filter(o)}},droots:function(t){if(3===t.length){const e=t[0],n=t[1],i=t[2],o=e-2*n+i;if(0!==o){const t=-y(n*n-e*i),r=-e+n;return[-(t+r)/o,-(-t+r)/o]}return n!==i&&0===o?[(2*n-i)/(2*(n-i))]:[]}if(2===t.length){const e=t[0],n=t[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(t,e,n,i,o){let r,s,c,l,a=0,u=0;const f=T.compute(t,e),d=T.compute(t,n),p=f.x*f.x+f.y*f.y;if(i?(r=y(g(f.y*d.z-d.y*f.z,2)+g(f.z*d.x-d.z*f.x,2)+g(f.x*d.y-d.x*f.y,2)),s=g(p+f.z*f.z,1.5)):(r=f.x*d.y-f.y*d.x,s=g(p,1.5)),0===r||0===s)return{k:0,r:0};if(a=r/s,u=s/r,!o){const o=T.curvature(t-.001,e,n,i,!0).k,r=T.curvature(t+.001,e,n,i,!0).k;l=(r-a+(a-o))/2,c=(h(r-a)+h(a-o))/2}return{k:a,r:u,dk:l,adk:c}},inflections:function(t){if(t.length<4)return[];const e=T.align(t,{p1:t[0],p2:t.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,o=e[1].x*e[2].y,r=18*(-3*n+2*i+3*o-e[3].x*e[2].y),s=18*(3*n-i-3*o),c=18*(o-n);if(T.approximately(r,0)){if(!T.approximately(s,0)){let t=-c/s;if(0<=t&&t<=1)return[t]}return[]}const l=s*s-4*r*c,a=Math.sqrt(l),u=2*r;return T.approximately(u,0)?[]:[(a-s)/u,-(s+a)/u].filter((function(t){return 0<=t&&t<=1}))},bboxoverlap:function(t,e){const n=["x","y"],i=n.length;for(let o,r,s,c,l=0;l<i;l++)if(o=n[l],r=t[o].mid,s=e[o].mid,c=(t[o].size+e[o].size)/2,h(r-s)>=c)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,n){const i=t.bbox(),o=e.bbox(),r=1e5,s=n||.5;if(i.x.size+i.y.size<s&&o.x.size+o.y.size<s)return[(r*(t._t1+t._t2)/2|0)/r+"/"+(r*(e._t1+e._t2)/2|0)/r];let c=t.split(.5),l=e.split(.5),a=[{left:c.left,right:l.left},{left:c.left,right:l.right},{left:c.right,right:l.right},{left:c.right,right:l.left}];a=a.filter((function(t){return T.bboxoverlap(t.left.bbox(),t.right.bbox())}));let u=[];return 0===a.length||(a.forEach((function(t){u=u.concat(T.pairiteration(t.left,t.right,s))})),u=u.filter((function(t,e){return u.indexOf(t)===e}))),u},getccenter:function(t,e,n){const i=e.x-t.x,o=e.y-t.y,r=n.x-e.x,s=n.y-e.y,c=i*f(w)-o*d(w),l=i*d(w)+o*f(w),a=r*f(w)-s*d(w),u=r*d(w)+s*f(w),h=(t.x+e.x)/2,p=(t.y+e.y)/2,y=(e.x+n.x)/2,g=(e.y+n.y)/2,x=h+c,v=p+l,z=y+a,_=g+u,E=T.lli8(h,p,x,v,y,g,z,_),k=T.dist(E,t);let A,S=m(t.y-E.y,t.x-E.x),C=m(e.y-E.y,e.x-E.x),j=m(n.y-E.y,n.x-E.x);return S<j?((S>C||C>j)&&(S+=b),S>j&&(A=j,j=S,S=A)):j<C&&C<S?(A=j,j=S,S=A):j+=b,E.s=S,E.e=j,E.r=k,E},numberSort:function(t,e){return t-e}};class k{constructor(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(t){return T.pointsToString(t.points)})).join(", ")+"]"}addCurve(t){this.curves.push(t),this._3d=this._3d||t._3d}length(){return this.curves.map((function(t){return t.length()})).reduce((function(t,e){return t+e}))}curve(t){return this.curves[t]}bbox(){const t=this.curves;for(var e=t[0].bbox(),n=1;n<t.length;n++)T.expandbox(e,t[n].bbox());return e}offset(t){const e=[];return this.curves.forEach((function(n){e.push(...n.offset(t))})),new k(e)}}const{abs:A,min:S,max:C,cos:j,sin:M,acos:L,sqrt:O}=Math,D=Math.PI;class I{constructor(t){let e=t&&t.forEach?t:Array.from(arguments).slice(),n=!1;if("object"==typeof e[0]){n=e.length;const t=[];e.forEach((function(e){["x","y","z"].forEach((function(n){void 0!==e[n]&&t.push(e[n])}))})),e=t}let i=!1;const o=e.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");i=!0}}else if(6!==o&&8!==o&&9!==o&&12!==o&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const r=this._3d=!i&&(9===o||12===o)||t&&t[0]&&void 0!==t[0].z,s=this.points=[];for(let t=0,n=r?3:2;t<o;t+=n){var c={x:e[t],y:e[t+1]};r&&(c.z=e[t+2]),s.push(c)}const l=this.order=s.length-1,a=this.dims=["x","y"];r&&a.push("z"),this.dimlen=a.length;const u=T.align(s,{p1:s[0],p2:s[l]});this._linear=!u.some((t=>A(t.y)>1e-4)),this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(t,e,n,i){if(void 0===i&&(i=.5),0===i)return new I(e,e,n);if(1===i)return new I(t,e,e);const o=I.getABC(2,t,e,n,i);return new I(t,o.A,n)}static cubicFromPoints(t,e,n,i,o){void 0===i&&(i=.5);const r=I.getABC(3,t,e,n,i);void 0===o&&(o=T.dist(e,r.C));const s=o*(1-i)/i,c=T.dist(t,n),l=(n.x-t.x)/c,a=(n.y-t.y)/c,u=o*l,h=o*a,f=s*l,d=s*a,p=e.x-u,m=e.y-h,y=e.x+f,g=e.y+d,x=r.A,v=x.x+(p-x.x)/(1-i),b=x.y+(m-x.y)/(1-i),w=x.x+(y-x.x)/i,z=x.y+(g-x.y)/i,_={x:t.x+(v-t.x)/i,y:t.y+(b-t.y)/i},E={x:n.x+(w-n.x)/(1-i),y:n.y+(z-n.y)/(1-i)};return new I(t,_,E,n)}static getUtils(){return T}getUtils(){return I.getUtils()}static get PolyBezier(){return k}valueOf(){return this.toString()}toString(){return T.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const t=this.points,e=["M",t[0].x,t[0].y,2===this.order?"Q":"C"];for(let n=1,i=t.length;n<i;n++)e.push(t[n].x),e.push(t[n].y);return e.join(" ")}setRatios(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]}verify(){const t=this.coordDigest();t!==this._print&&(this._print=t,this.update())}coordDigest(){return this.points.map((function(t,e){return""+e+t.x+t.y+(t.z?t.z:0)})).join("")}update(){this._lut=[],this.dpoints=T.derive(this.points,this._3d),this.computedirection()}computedirection(){const t=this.points,e=T.angle(t[0],t[this.order],t[1]);this.clockwise=e>0}length(){return T.length(this.derivative.bind(this))}static getABC(t=2,e,n,i,o=.5){const r=T.projectionratio(o,t),s=1-r,c={x:r*e.x+s*i.x,y:r*e.y+s*i.y},l=T.abcratio(o,t);return{A:{x:n.x+(n.x-c.x)/l,y:n.y+(n.y-c.y)/l},B:n,C:c,S:e,E:i}}getABC(t,e){e=e||this.get(t);let n=this.points[0],i=this.points[this.order];return I.getABC(this.order,n,e,i,t)}getLUT(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(let e,n,i=0;i<t;i++)n=i/(t-1),e=this.compute(n),e.t=n,this._lut.push(e);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),o=[];for(let t,r=0,s=0;r<i.length;r++)t=i[r],T.dist(t,e)<n&&(o.push(t),s+=r/i.length);return!!o.length&&(t/=o.length)}project(t){const e=this.getLUT(),n=e.length-1,i=T.closest(e,t),o=i.mpos,r=(o-1)/n,s=(o+1)/n,c=.1/n;let l,a,u=i.mdist,h=r,f=h;for(u+=1;h<s+c;h+=c)l=this.compute(h),a=T.dist(t,l),a<u&&(u=a,f=h);return f=f<0?0:f>1?1:f,l=this.compute(f),l.t=f,l.d=u,l}get(t){return this.compute(t)}point(t){return this.points[t]}compute(t){return this.ratios?T.computeWithRatios(t,this.points,this.ratios,this._3d):T.compute(t,this.points,this._3d,this.ratios)}raise(){const t=this.points,e=[t[0]],n=t.length;for(let i,o,r=1;r<n;r++)i=t[r],o=t[r-1],e[r]={x:(n-r)/n*i.x+r/n*o.x,y:(n-r)/n*i.y+r/n*o.y};return e[n]=t[n-1],new I(e)}derivative(t){return T.compute(t,this.dpoints[0],this._3d)}dderivative(t){return T.compute(t,this.dpoints[1],this._3d)}align(){let t=this.points;return new I(T.align(t,{p1:t[0],p2:t[t.length-1]}))}curvature(t){return T.curvature(t,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return T.inflections(this.points)}normal(t){return this._3d?this.__normal3(t):this.__normal2(t)}__normal2(t){const e=this.derivative(t),n=O(e.x*e.x+e.y*e.y);return{x:-e.y/n,y:e.x/n}}__normal3(t){const e=this.derivative(t),n=this.derivative(t+.01),i=O(e.x*e.x+e.y*e.y+e.z*e.z),o=O(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=i,e.y/=i,e.z/=i,n.x/=o,n.y/=o,n.z/=o;const r={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},s=O(r.x*r.x+r.y*r.y+r.z*r.z);r.x/=s,r.y/=s,r.z/=s;const c=[r.x*r.x,r.x*r.y-r.z,r.x*r.z+r.y,r.x*r.y+r.z,r.y*r.y,r.y*r.z-r.x,r.x*r.z-r.y,r.y*r.z+r.x,r.z*r.z];return{x:c[0]*e.x+c[1]*e.y+c[2]*e.z,y:c[3]*e.x+c[4]*e.y+c[5]*e.z,z:c[6]*e.x+c[7]*e.y+c[8]*e.z}}hull(t){let e=this.points,n=[],i=[],o=0;for(i[o++]=e[0],i[o++]=e[1],i[o++]=e[2],3===this.order&&(i[o++]=e[3]);e.length>1;){n=[];for(let r,s=0,c=e.length-1;s<c;s++)r=T.lerp(t,e[s],e[s+1]),i[o++]=r,n.push(r);e=n}return i}split(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;const n=this.hull(t),i={left:2===this.order?new I([n[0],n[3],n[5]]):new I([n[0],n[4],n[7],n[9]]),right:2===this.order?new I([n[5],n[4],n[2]]):new I([n[9],n[8],n[6],n[3]]),span:n};return i.left._t1=T.map(0,0,1,this._t1,this._t2),i.left._t2=T.map(t,0,1,this._t1,this._t2),i.right._t1=T.map(t,0,1,this._t1,this._t2),i.right._t2=T.map(1,0,1,this._t1,this._t2),e?(e=T.map(e,t,1,0,1),i.right.split(e).left):i}extrema(){const t={};let e=[];return this.dims.forEach(function(n){let i=function(t){return t[n]},o=this.dpoints[0].map(i);t[n]=T.droots(o),3===this.order&&(o=this.dpoints[1].map(i),t[n]=t[n].concat(T.droots(o))),t[n]=t[n].filter((function(t){return t>=0&&t<=1})),e=e.concat(t[n].sort(T.numberSort))}.bind(this)),t.values=e.sort(T.numberSort).filter((function(t,n){return e.indexOf(t)===n})),t}bbox(){const t=this.extrema(),e={};return this.dims.forEach(function(n){e[n]=T.getminmax(this,n,t[n])}.bind(this)),e}overlaps(t){const e=this.bbox(),n=t.bbox();return T.bboxoverlap(e,n)}offset(t,e){if(void 0!==e){const n=this.get(t),i=this.normal(t),o={c:n,n:i,x:n.x+i.x*e,y:n.y+i.y*e};return this._3d&&(o.z=n.z+i.z*e),o}if(this._linear){const e=this.normal(0),n=this.points.map((function(n){const i={x:n.x+t*e.x,y:n.y+t*e.y};return n.z&&e.z&&(i.z=n.z+t*e.z),i}));return[new I(n)]}return this.reduce().map((function(e){return e._linear?e.offset(t)[0]:e.scale(t)}))}simple(){if(3===this.order){const t=T.angle(this.points[0],this.points[3],this.points[1]),e=T.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&e<0||t<0&&e>0)return!1}const t=this.normal(0),e=this.normal(1);let n=t.x*e.x+t.y*e.y;return this._3d&&(n+=t.z*e.z),A(L(n))<D/3}reduce(){let t,e,n=0,i=0,o=.01,r=[],s=[],c=this.extrema().values;for(-1===c.indexOf(0)&&(c=[0].concat(c)),-1===c.indexOf(1)&&c.push(1),n=c[0],t=1;t<c.length;t++)i=c[t],e=this.split(n,i),e._t1=n,e._t2=i,r.push(e),n=i;return r.forEach((function(t){for(n=0,i=0;i<=1;)for(i=n+o;i<=1.01;i+=o)if(e=t.split(n,i),!e.simple()){if(i-=o,A(n-i)<o)return[];e=t.split(n,i),e._t1=T.map(n,0,1,t._t1,t._t2),e._t2=T.map(i,0,1,t._t1,t._t2),s.push(e),n=i;break}n<1&&(e=t.split(n,1),e._t1=T.map(n,0,1,t._t1,t._t2),e._t2=t._t2,s.push(e))})),s}scale(t){const e=this.order;let n=!1;if("function"==typeof t&&(n=t),n&&2===e)return this.raise().scale(n);const i=this.clockwise,o=n?n(0):t,r=n?n(1):t,s=[this.offset(0,10),this.offset(1,10)],c=this.points,l=[],a=T.lli4(s[0],s[0].c,s[1],s[1].c);if(!a)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(t){const n=l[t*e]=T.copy(c[t*e]);n.x+=(t?r:o)*s[t].n.x,n.y+=(t?r:o)*s[t].n.y})),n?([0,1].forEach((function(o){if(2!==e||!o){var r=c[o+1],s={x:r.x-a.x,y:r.y-a.y},u=n?n((o+1)/e):t;n&&!i&&(u=-u);var h=O(s.x*s.x+s.y*s.y);s.x/=h,s.y/=h,l[o+1]={x:r.x+u*s.x,y:r.y+u*s.y}}})),new I(l)):([0,1].forEach((t=>{if(2===e&&t)return;const n=l[t*e],i=this.derivative(t),o={x:n.x+i.x,y:n.y+i.y};l[t+1]=T.lli4(n,o,a,c[t+1])})),new I(l))}outline(t,e,n,i){e=void 0===e?t:e;const o=this.reduce(),r=o.length,s=[];let c,l=[],a=0,u=this.length();const h=void 0!==n&&void 0!==i;function f(t,e,n,i,o){return function(r){const s=i/n,c=(i+o)/n,l=e-t;return T.map(r,0,1,t+s*l,t+c*l)}}o.forEach((function(o){const r=o.length();h?(s.push(o.scale(f(t,n,u,a,r))),l.push(o.scale(f(-e,-i,u,a,r)))):(s.push(o.scale(t)),l.push(o.scale(-e))),a+=r})),l=l.map((function(t){return c=t.points,c[3]?t.points=[c[3],c[2],c[1],c[0]]:t.points=[c[2],c[1],c[0]],t})).reverse();const d=s[0].points[0],p=s[r-1].points[s[r-1].points.length-1],m=l[r-1].points[l[r-1].points.length-1],y=l[0].points[0],g=T.makeline(m,d),x=T.makeline(p,y),v=[g].concat(s).concat([x]).concat(l);return v.length,new k(v)}outlineshapes(t,e,n){e=e||t;const i=this.outline(t,e).curves,o=[];for(let t=1,e=i.length;t<e/2;t++){const r=T.makeshape(i[t],i[e-t],n);r.startcap.virtual=t>1,r.endcap.virtual=t<e/2-1,o.push(r)}return o}intersects(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof I&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)}lineIntersects(t){const e=S(t.p1.x,t.p2.x),n=S(t.p1.y,t.p2.y),i=C(t.p1.x,t.p2.x),o=C(t.p1.y,t.p2.y);return T.roots(this.points,t).filter((t=>{var r=this.get(t);return T.between(r.x,e,i)&&T.between(r.y,n,o)}))}selfintersects(t){const e=this.reduce(),n=e.length-2,i=[];for(let o,r,s,c=0;c<n;c++)r=e.slice(c,c+1),s=e.slice(c+2),o=this.curveintersects(r,s,t),i.push(...o);return i}curveintersects(t,e,n){const i=[];t.forEach((function(t){e.forEach((function(e){t.overlaps(e)&&i.push({left:t,right:e})}))}));let o=[];return i.forEach((function(t){const e=T.pairiteration(t.left,t.right,n);e.length>0&&(o=o.concat(e))})),o}arcs(t){return t=t||.5,this._iterate(t,[])}_error(t,e,n,i){const o=(i-n)/4,r=this.get(n+o),s=this.get(i-o),c=T.dist(t,e),l=T.dist(t,r),a=T.dist(t,s);return A(l-c)+A(a-c)}_iterate(t,e){let n,i=0,o=1;do{n=0,o=1;let r,s,c,l,a,u=this.get(i),h=!1,f=!1,d=o,p=1,m=0;do{if(f=h,l=c,d=(i+o)/2,m++,r=this.get(d),s=this.get(o),c=T.getccenter(u,r,s),c.interval={start:i,end:o},h=this._error(c,u,i,o)<=t,a=f&&!h,a||(p=o),h){if(o>=1){if(c.interval.end=p=1,l=c,o>1){let t={x:c.x+c.r*j(c.e),y:c.y+c.r*M(c.e)};c.e+=T.angle({x:c.x,y:c.y},t,this.get(1))}break}o+=(o-i)/2}else o=d}while(!a&&n++<100);if(n>=100)break;l=l||c,e.push(l),i=p}while(o<1);return e}}const N=.04,W=.16,q=.1;function U(t){if("number"==typeof t&&isFinite(t))return{row:t,column:t};if("string"==typeof t){let[e,n]=t.split(/\s+/,2).map(Number);return isFinite(e)||(e=2.4),isFinite(n)||(n=1.8),{row:n,column:e}}return{row:1.8,column:2.4}}function B(t,e,n){if("number"==typeof t&&isFinite(t))return{row:n.row,column:n.column+t};if("string"!=typeof t)return"from"===e?{row:n.row,column:n.column}:{row:n.row,column:n.column+1};const[i,o]=t.split(/\s+/,2).map((t=>Number(t??0)));return isFinite(i)&&isFinite(o)?{row:n.row+o,column:n.column+i}:t}function F(t){if("number"==typeof t&&isFinite(t))return{angle:t,strength:1};if(!0===t)return{angle:30,strength:1};if("string"!=typeof t)return;let[e,n]=t.split(/\s+/,2).map(Number);return isFinite(e)||(e=0),isFinite(n)||(n=1),{angle:e,strength:n}}function $(t){return"number"==typeof t&&isFinite(t)?t:!0===t?.24:0}function P(t){return"two"===t||"squiggle"===t?t:"one"}function R(t,e,n){return"none"===t?t:"arrow"===t?"two"===n?"Arrow":t:"bar"===t?"two"===n?"Bar":t:"harpoon"===t||"harpoon-"===t||"hook"===t||"hook-"===t||"two"===t||"tail"===t?"two"===n?"none":t:"tail"===e?"none":"two"===n?"Arrow":"arrow"}function H(t,e,i){const o=[],s={tag:"katex"===e?e:"div",options:{},children:[]};for(const e of t){if(0===e.length){s.children.push(e);continue}const t=e[0];if("string"==typeof t){s.children.push(e);continue}let{at:c,shift:l}=t.options;if(void 0===c&&void 0===l)s.children.push(e);else{("number"!=typeof c||c<0||c>1)&&(c=.5),"number"==typeof l&&isFinite(l)||(l=.8);let e=t.options["cd-id"];"string"!=typeof e&&(e=n(t.children)),e=r(e);const s=i[e]=(i[e]??0)+1,a=s>1||0===e.length?`${e}~${s}`:e;o.push({at:c,shift:l,unit:t,id:a})}}if(s.children.length>0){const t=r(n(s.children)),e=i[t]=(i[t]??0)+1,c=e>1||0===t.length?`${t}~${e}`:t;o.push({at:.5,shift:.8,unit:s,id:c})}return o}function G(t){return{x:Math.cos(t/180*Math.PI),y:-Math.sin(t/180*Math.PI)}}function V(t){const e=Math.acos(t.x)/Math.PI*180;return t.y<=0?e:360-e}function J(t,e,n){if((t%=360)<0&&(t+=360),0===t)return{x:e.x+n.width/2,y:e.y};if(180===t)return{x:e.x-n.width/2,y:e.y};if(90===t)return{x:e.x,y:e.y-n.top};if(270===t)return{x:e.x,y:e.y+n.bottom};const i=Math.abs(Math.tan(t/180*Math.PI));if(t<90){const t=Math.min(n.width/2,n.top/i),o=Math.min(n.top,n.width*i/2);return{x:e.x+t,y:e.y-o}}if(t<180){const t=Math.min(n.width/2,n.top/i),o=Math.min(n.top,n.width*i/2);return{x:e.x-t,y:e.y-o}}if(t<270){const t=Math.min(n.width/2,n.bottom/i),o=Math.min(n.bottom,n.width*i/2);return{x:e.x-t,y:e.y+o}}const o=Math.min(n.width/2,n.bottom/i),r=Math.min(n.bottom,n.width*i/2);return{x:e.x+o,y:e.y+r}}const Y=[5.4,6.5,4.8,3,2,1,0,0],Z=[4.5,7.5,3,4.5,-1.5,1,-4.5,0],K=[0,0,-6,0,-6,-5,0,-5],Q=[0,5,0,0,0,-5],X=[0,7.5,0,0,0,-7.5];function tt(t,e,n){function i(...t){const i=[],o=Math.floor(t.length/2);for(let s=0;s<o;s++){const o=2*s,{x:c,y:l}=(r={x:t[o],y:t[o+1]},{x:n.x+r.x*N*e.x-r.y*N*e.y,y:n.y+r.y*N*e.x+r.x*N*e.y});i.push(c,l)}var r;return i}switch(t){case"harpoon":return[new I(i(...Y))];case"harpoon-":return[new I(i(...Y.map(((t,e)=>e%2==0?t:-t))))];case"arrow":return[new I(i(...Y)),new I(i(...Y.map(((t,e)=>e%2==0?t:-t))))];case"Arrow":return[new I(i(...Z)),new I(i(...Z.map(((t,e)=>e%2==0?t:-t))))];case"tail":return[new I(i(...Y.map(((t,e)=>e%2==0?-t:t)))),new I(i(...Y.map((t=>-t))))];case"two":return[new I(i(...Y)),new I(i(...Y.map(((t,e)=>e%2==0?t:-t)))),new I(i(...Y.map(((t,e)=>e%2==0?t+4.5:t)))),new I(i(...Y.map(((t,e)=>e%2==0?t+4.5:-t))))];case"hook":return[new I(i(...K))];case"hook-":return[new I(i(...K.map(((t,e)=>e%2==0?t:-t))))];case"bar":return[new I(i(...Q))];case"Bar":return[new I(i(...X))];case"none":return[]}}function et(t,e){const n=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div");return n.style.position="absolute",n.style.top="0",n.style.width="0",n.style.display="flex",n.style.justifyContent="center",o.style.display="inline-block",r.style.display="inline-block",r.style.verticalAlign="-0.5ex",r.style.width="max-content",e.append(n),n.append(i),i.append(o),i.append(r),r.append(t),{leftControler:n,topControler:o,container:r}}function nt(t,e){t.leftControler.style.left=e.x+"em",t.topControler.style.height=e.y+"em"}function it(t,e,n,i){const{height:o,width:r}=t.container.getBoundingClientRect(),s=o*e,c=r*n;t.topControler.style.height=s+"em";const{top:l}=t.topControler.getBoundingClientRect(),{top:a}=t.container.getBoundingClientRect(),u=Math.min(s,(a-l)*e);return{height:s+2*i,width:c+2*i,top:s-u+i,bottom:u+i}}function ot(t){let e=0;const n=[];for(const i of t){const t=i.length();t>0&&(e+=t,n.push({length:t,bezier:i}))}if(e<1||0===n.length)return t;const i=.25,o=Math.floor(e/i)-1,r=i,s=o*i,c=[];let l,a=0,u=0;for(const{length:t,bezier:e}of n){const n=u+t;if(u<r&&(n<=r?c.push(e):c.push(e.split(0,(r-u)/t))),a<o)for(;;){const r=(a+1)*i;if(r>n)break;const s=e.get((r-u)/t);if(void 0!==l){const t=s.x-l.x,e=s.y-l.y,n=Math.sqrt(t**2+e**2);if(n>0){const i={x:t/n,y:e/n},o={x:(l.x+s.x)/2,y:(l.y+s.y)/2};a%2==1?(o.x+=i.y*q,o.y-=i.x*q):(o.x-=i.y*q,o.y+=i.x*q),c.push(new I(l.x,l.y,(l.x+o.x)/2,(l.y+o.y)/2,o.x,o.y)),c.push(new I(o.x,o.y,(o.x+s.x)/2,(o.y+s.y)/2,s.x,s.y))}}if(l=s,a++,a===o)break}n>s&&(u>=s?c.push(e):c.push(e.split((s-u)/t,1))),u=n}return c}const rt=async(t,e)=>{const i=U(t.options.gap),o=document.createElement("div"),s=document.createElementNS("http://www.w3.org/2000/svg","svg");o.classList.add("cd"),o.style.position="relative",s.style.position="absolute",s.style.left="0",s.style.top="0",o.append(s);let c={children:[],id:""},l=[c];const a=[l],u=[],h={};for(const e of t.children)if(0!==e.length){{const t=e[0];if("string"!=typeof t){if("ar"===t.tag||"katex"===t.tag&&!0===t.options.ar){const e={row:a.length-1,column:l.length-1},n=P(t.options.body),i=H(t.children,t.tag,h);u.push({from:B(t.options.from,"from",e),to:B(t.options.to,"to",e),out:F(t.options.out),in:F(t.options.in),bend:F(t.options.bend),shift:$(t.options.shift),body:n,head:R(t.options.head,"head",n),tail:R(t.options.tail,"tail",n),labels:i,class:"string"==typeof t.options.class?t.options.class:"",style:"string"==typeof t.options.style?t.options.style:""});continue}}else{if("&"===t&&1===e.length){l.push(c={children:[],id:""});continue}if("\\"===t&&2===e.length&&"\\"===e[1]){a.push(l=[c={children:[],id:""}]);continue}}}if(c.children.push(e),0===c.id.length){const t=r(n([e]));if(0===t.length)continue;const i=h[t]=(h[t]??0)+1,o=i>1||0===t.length?`${t}~${i}`:t;c.id=o}}else c.children.push(e);const f={},d=[];for(let n=0;n<a.length;n++){const i=a[n];for(let r=0;r<i.length;r++){const{children:s,id:c}=i[r];0!==s.length&&(d.push({element:et("CD"===t.tag?await e.compileUnit({tag:"katex",options:{},children:s}):await e.compileSTDN(s),o),position:{row:n,column:r},id:c}),c.length>0&&(f[c]=!0))}}const p={},m=[];let y=u;for(;;){const t=[];for(const n of y){const{from:i,to:r}=n;if("string"!=typeof i||f[i])if("string"!=typeof r||f[r]){m.push(n);for(const{unit:t,id:i}of n.labels){const n=et(await e.compileUnit(t),o);!0!==t.options["normal-font-size"]&&(n.container.style.fontSize="var(--length-font-log)"),p[i]=n,f[i]=!0}}else t.push(n);else t.push(n)}if(y.length===t.length)break;y=t}function g(){s.innerHTML="";const t=[],e=[],n=Number(getComputedStyle(o).fontSize.slice(0,-2));let r=1/n,c=1/n;const l=o.closest("foreignObject");if(null!==l){const{height:t,width:e}=l.getBoundingClientRect();r*=l.height.animVal.value/t,c*=l.width.animVal.value/e}const a={},u={};for(const{element:n,position:i,id:o}of d){const s=it(n,r,c,.5);a[i.row+" "+i.column]=s,o.length>0&&(u[o]=s),(t[i.row]??0)<s.height&&(t[i.row]=s.height),(e[i.column]??0)<s.width&&(e[i.column]=s.width)}function h(n){let o=n.column>=0?(e[0]??0)/2:0,r=n.row>=0?(t[0]??0)/2:0;for(let t=1;t<=n.column;t++){const n=e[t-1],r=e[t];void 0!==n&&(o+=n/2,void 0!==r&&(o+=i.column)),void 0!==r&&(o+=r/2)}if(n.column%1!=0){const t=Math.floor(n.column),r=e[t],s=e[t+1];void 0!==r&&(o+=(n.column-t)*r/2,void 0!==s&&(o+=(n.column-t)*i.column)),void 0!==s&&(o+=(n.column-t)*s/2)}for(let e=1;e<=n.row;e++){const n=t[e-1],o=t[e];void 0!==n&&(r+=n/2,void 0!==o&&(r+=i.row)),void 0!==o&&(r+=o/2)}if(n.row%1!=0){const e=Math.floor(n.row),o=t[e],s=t[e+1];void 0!==o&&(r+=(n.row-e)*o/2,void 0!==s&&(r+=(n.row-e)*i.row)),void 0!==s&&(r+=(n.row-e)*s/2)}return{x:o,y:r}}const f={};for(const{position:t,id:e}of d){const n=h(t);e.length>0&&(f[e]=n)}let y=0,g=0,x=h({row:0,column:e.length}).x,v=h({row:t.length,column:0}).y;function b(t,e){const n=[];for(const e of t){n.push(e.toSVG());const{x:t,y:i}=e.bbox(),o=t.min-N,r=t.max+N,s=i.min-N,c=i.max+N;o<y&&(y=o),r>x&&(x=r),s<g&&(g=s),c>v&&(v=c)}const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",n.join(" ")),i.style.strokeWidth="0.04px",i.style.fill="none",e.append(i)}function w(t,e,n){const i=t.offset(-e);Array.isArray(i)&&b(i,n)}function z(t,e,n){const i=t.offset(-e);Array.isArray(i)&&b(ot(i),n)}for(const{from:t,to:e,out:n,in:i,bend:o,head:l,tail:d,shift:_,body:E,class:T,style:k,labels:A}of m){let m,S,C,j,M,L,O,D,N,U;if("string"!=typeof t){m=h(t);const e=a[t.row+" "+t.column];C=void 0===e?{height:0,width:0,top:0,bottom:0}:e}else{const e=f[t],n=u[t];if(void 0===e||void 0===n)continue;m=e,C=n}if("string"!=typeof e){S=h(e);const t=a[e.row+" "+e.column];j=void 0===t?{height:0,width:0,top:0,bottom:0}:t}else{const t=f[e],n=u[e];if(void 0===t||void 0===n)continue;S=t,j=n}if(void 0===n||void 0===i){const t=S.x-m.x,e=S.y-m.y,r=Math.sqrt(t**2+e**2);if(0===r)continue;const s=V({x:t/r,y:e/r});let c=0,l=1;if(void 0!==o&&(c=o.angle,l=o.strength),void 0===n){const t=s+c;M=J(t,m,C),O=G(t),N=l}else M=J(n.angle,m,C),O=G(n.angle),N=n.strength;if(void 0===i){const t=s+180-c;L=J(t,S,j),D=G(t),U=l}else L=J(i.angle,S,j),D=G(i.angle),U=i.strength}else M=J(n.angle,m,C),L=J(i.angle,S,j),O=G(n.angle),D=G(i.angle),N=n.strength,U=i.strength;"Arrow"!==l&&"hook"!==l&&"hook-"!==l&&"tail"!==l||(L.x=L.x+D.x*W,L.y=L.y+D.y*W),"Arrow"!==d&&"hook"!==d&&"hook-"!==d&&"tail"!==d||(M.x=M.x+O.x*W,M.y=M.y+O.y*W);const B=Math.sqrt((L.x-M.x)**2+(L.y-M.y)**2);if(0===B)continue;const F={x:M.x+O.x*B/3*N,y:M.y+O.y*B/3*N},$={x:L.x+D.x*B/3*U,y:L.y+D.y*B/3*U},P=new I(M.x,M.y,F.x,F.y,$.x,$.y,L.x,L.y),R=document.createElementNS("http://www.w3.org/2000/svg","g");try{R.setAttribute("class",T)}catch(t){console.log(t)}try{R.setAttribute("style",k)}catch(t){console.log(t)}s.append(R),"two"===E?(w(P,_+q,R),w(P,_-q,R)):"squiggle"===E?z(P,_,R):w(P,_,R);{const t=tt(l,D,{x:L.x-D.y*_,y:L.y+D.x*_});t.length>0&&b(t,R)}{const t=tt(d,O,{x:M.x+O.y*_,y:M.y-O.x*_});t.length>0&&b(t,R)}for(const{at:t,shift:e,id:n}of A){const i=P.get(t),o=P.normal(t);let s=_+e;"two"!==E&&"squiggle"!==E||0===e||(s+=q*Math.sign(e));const l={x:i.x-o.x*s,y:i.y-o.y*s};f[n]=l;const a=p[n];if(void 0===a)throw new Error;const h=it(a,r,c,.3);u[n]=h;const d=l.x-h.width/2,m=l.x+h.width/2,b=l.y-h.top,w=l.y+h.bottom;d<y&&(y=d),m>x&&(x=m),b<g&&(g=b),w>v&&(v=w)}}const _=x-y,E=v-g;o.style.width=s.style.width=_+"em",o.style.height=s.style.height=E+"em",s.setAttribute("viewBox",`${y} ${g} ${_} ${E}`);for(const{element:t,position:e}of d){const n=h(e);nt(t,{x:n.x-y,y:n.y-g})}for(const t of Object.keys(p)){const e=p[t],n=f[t];void 0!==e&&void 0!==n&&nt(e,{x:n.x-y,y:n.y-g})}return s.innerHTML}const x=new MutationObserver((async()=>{if(!o.isConnected)return;let t;x.disconnect();let e=0;for(;;){const n=g();if(n===t&&(e++,1===e))break;t=n,await new Promise((t=>setTimeout(t,1e3)))}}));return x.observe(document.body,{childList:!0,subtree:!0}),o},st=rt})();var r=o.CD,s=o.W7,c=o.aC,l=o.cd,a=o.ib,u=o.Zg,h=o.rY,f=o.T_,d=o.in,p=o.vi,m=o.vy,y=o.Im,g=o.D8,x=o.xA,v=o.li,b=o.$U,w=o.AY;export{r as CD,s as absoluteElementToBox,c as angleToD,l as cd,a as createAbsoluteElement,u as createArrowMark,h as dToAngle,f as extractLabels,d as getEdgePoint,p as parseArrowBody,m as parseArrowMark,y as parseArrowShift,g as parseControl,x as parseGap,v as parsePosition,b as piecesToSquiggle,w as placeAbsoluteElement};